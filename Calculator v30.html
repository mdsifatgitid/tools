

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>কম্বাইন্ড ক্যালকুলেটর</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom font and basic styles */
        /* SUTONNYMJ ফন্টটি লোড করার জন্য @font-face ব্যবহার করা হয়েছে। */
        /* মোবাইল ডিভাইসে দ্রুত এবং নির্ভরযোগ্য লোডিং নিশ্চিত করতে jsDelivr CDN ব্যবহার করা হয়েছে। */
        @font-face {
            font-family: 'SUTONNYMJ';
            src: url('https://cdn.jsdelivr.net/gh/mdsifatgitid/mdsifatgitid.github.io/SUTONNYMJ.TTF') format('truetype');
            font-weight: normal;
            font-style: normal;
        }

        body {
            font-family: 'Inter', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #e0f2f7; /* হালকা নীল ব্যাকগ্রাউন্ড */
            padding: 10px; /* ছোট স্ক্রিনের জন্য প্যাডিং যোগ করুন */
        }

        .main-container {
            background-color: #ffffff; /* প্রধান কন্টেইনারের জন্য সাদা ব্যাকগ্রাউন্ড */
            padding: 20px; /* বর্ধিত প্যাডিং */
            border-radius: 20px; /* গোলাকার কোণ */
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15); /* গভীর ছায়া */
            max-width: 1000px; /* সমস্ত কন্টেন্টের জন্য বর্ধিত সর্বোচ্চ প্রস্থ */
            width: 100%; /* প্রতিক্রিয়াশীল প্রস্থ */
            text-align: center;
        }

        .tab-buttons {
            display: flex;
            justify-content: center;
            margin-bottom: 20px; /* বর্ধিত মার্জিন */
            gap: 10px; /* বর্ধিত ফাঁক */
            flex-wrap: wrap; /* ছোট স্ক্রিনে ট্যাবগুলি মোড়ানো */
        }

        .tab-button {
            padding: 10px 16px; /* বর্ধিত প্যাডিং */
            background-color: #e0e7ff; /* হালকা নীল */
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 0.9rem; /* সামঞ্জস্যপূর্ণ ফন্ট সাইজ */
            font-weight: 600;
            color: #3f51b5; /* গাঢ় নীল টেক্সট */
            transition: background-color 0.3s ease, transform 0.2s ease;
        }

        .tab-button.active {
            background-color: #3f51b5; /* সক্রিয় ট্যাবের রঙ (গভীর নীল) */
            color: white;
            box-shadow: 0 4px 8px rgba(63, 81, 181, 0.3);
            transform: translateY(-2px);
        }

        .tab-button:hover:not(.active) {
            background-color: #c5cae9; /* হোভারে হালকা নীল */
            transform: translateY(-1px);
        }

        /* মৌলিক ক্যালকুলেটর স্টাইল */
        .calculator-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr); /* 4 কলাম, সমান প্রস্থ */
            grid-template-rows: minmax(100px, auto) repeat(5, 1fr); /* ডিসপ্লে এবং 5 সারি বোতাম */
            gap: 10px; /* বোতামগুলির মধ্যে ফাঁক */
            padding: 20px; /* বর্ধিত প্যাডিং */
            border-radius: 20px; /* গোলাকার কোণ */
            background-color: #263238; /* গাঢ় ধূসর/নীল ক্যালকুলেটর ব্যাকগ্রাউন্ড */
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3); /* ছায়া */
            margin: 0 auto; /* গ্রিডকে কেন্দ্র করুন */
            max-width: 380px; /* মৌলিক ক্যালকুলেটরের জন্য বর্ধিত প্রস্থ */
        }
        .output {
            grid-column: 1 / -1; /* ডিসপ্লে পূর্ণ প্রস্থ জুড়ে বিস্তৃত */
            background-color: #1c262b; /* ডিসপ্লে ব্যাকগ্রাউন্ড */
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            justify-content: space-around;
            padding: 12px; /* বর্ধিত প্যাডিং */
            border-radius: 12px; /* ডিসপ্লের জন্য গোলাকার কোণ */
            margin-bottom: 8px; /* বর্ধিত মার্জিন */
            height: 100px; /* বর্ধিত নির্দিষ্ট উচ্চতা */
            word-wrap: break-word; /* দীর্ঘ সংখ্যা ভাঙুন */
            word-break: break-all; /* দীর্ঘ সংখ্যা ভাঙুন */
            box-sizing: border-box; /* উচ্চতায় প্যাডিং এবং বর্ডার অন্তর্ভুক্ত করুন */
        }
        .output .previous-operand {
            color: rgba(255, 255, 255, 0.6); /* পূর্ববর্তী অপারেশনের রঙ */
            font-size: 1.5rem; /* বর্ধিত ফন্ট সাইজ */
            word-wrap: break-word; /* দীর্ঘ সংখ্যা ভাঙুন */
            word-break: break-all; /* দীর্ঘ সংখ্যা ভাঙুন */
            align-self: flex-end; /* ডানদিকে সারিবদ্ধ করুন */
            max-width: 100%; /* নিশ্চিত করুন যে এটি তার কন্টেইনারের বাইরে না যায় */
        }
        .output .current-operand {
            color: white; /* বর্তমান অপারেশনের রঙ */
            font-size: 3.2rem; /* বর্ধিত ফন্ট সাইজ */
            word-wrap: break-word; /* দীর্ঘ সংখ্যা ভাঙুন */
            word-break: break-all; /* দীর্ঘ সংখ্যা ভাঙুন */
            align-self: flex-end; /* ডানদিকে সারিবদ্ধ করুন */
            max-width: 100%; /* নিশ্চিত করুন যে এটি তার কন্টেইনারের বাইরে না যায় */
        }
        .calculator-button {
            cursor: pointer;
            font-size: 1.6rem; /* বর্ধিত ফন্ট সাইজ */
            border: none;
            outline: none;
            background-color: #455a64; /* বোতামের ব্যাকগ্রাউন্ড (নীল-ধূসর) */
            color: white; /* বোতামের টেক্সট রঙ */
            border-radius: 10px; /* বোতামগুলির জন্য গোলাকার কোণ */
            transition: background-color 0.2s ease-in-out, transform 0.1s ease; /* হোভার প্রভাব */
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        .calculator-button:hover {
            background-color: #546e7a; /* হোভারে ব্যাকগ্রাউন্ড */
            transform: translateY(-1px);
        }
        .operator {
            background-color: #007bff; /* নীল অপারেটর বোতামের রঙ */
        }
        .operator:hover {
            background-color: #0056b3; /* নীল অপারেটর হোভার রঙ */
        }
        .equals {
            background-color: #007bff; /* ইকুয়ালস বোতামের রঙ (নীল) */
        }
        .equals:hover {
            background-color: #0056b3; /* ইকুয়ালস বোতাম হোভার রঙ (গাঢ় নীল) */
        }
        .clear {
            grid-column: span 2; /* ক্লিয়ার বোতাম দুটি কলাম জুড়ে বিস্তৃত */
            background-color: #ef5350; /* লাল ক্লিয়ার বোতামের রঙ */
            color: white; /* ক্লিয়ার বোতামের টেক্সট রঙ */
        }
        .clear:hover {
            background-color: #d32f2f; /* লাল ক্লিয়ার বোতাম হোভার রঙ */
        }
        .zero {
            grid-column: span 2; /* জিরো বোতাম দুটি কলাম জুড়ে বিস্তৃত */
        }
        /* ব্যাখ্যা বোতামের জন্য নতুন স্টাইল */
        .explain-button {
            background-color: #28a745; /* সবুজ */
            color: white;
            padding: 10px 20px;
            font-size: 1rem;
            border-radius: 10px;
            margin-top: 15px;
            margin-bottom: 5px;
            display: block; /* ব্লক লেভেল উপাদান হিসাবে সেট করুন */
            margin-left: auto; /* কেন্দ্র করার জন্য */
            margin-right: auto; /* কেন্দ্র করার জন্য */
            width: fit-content; /* কন্টেন্টের আকারের সাথে প্রস্থ সামঞ্জস্য করুন */
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        .explain-button:hover {
            background-color: #218838;
            transform: translateY(-1px);
        }

        /* বয়স ক্যালকুলেটর স্টাইল */
        .age-calculator-content {
            padding: 20px; /* বর্ধিত প্যাডিং */
            border-radius: 16px;
            margin: 0 auto;
            max-width: 400px; /* বয়স ক্যালকুলেটরের জন্য বর্ধিত প্রস্থ */
            background-color: #f8f9fa; /* হালকা ধূসর ব্যাকগ্রাউন্ড */
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
        }
        .age-calculator-content .input-group {
            margin-bottom: 20px; /* বর্ধিত মার্জিন */
            text-align: left;
        }
        .age-calculator-content .input-group label {
            display: block;
            margin-bottom: 8px; /* বর্ধিত মার্জিন */
            font-size: 1.05rem; /* বর্ধিত ফন্ট সাইজ */
            color: #333;
            font-weight: 600;
        }
        .age-calculator-content .input-group input[type="date"] {
            width: 100%;
            padding: 12px; /* বর্ধিত প্যাডিং */
            border: 1px solid #cce7ff; /* হালকা নীল বর্ডার */
            border-radius: 10px;
            font-size: 1rem; /* বর্ধিত ফন্ট সাইজ */
            box-sizing: border-box; /* প্রস্থে প্যাডিং অন্তর্ভুক্ত করুন */
            appearance: none; /* ডিফল্ট তারিখ ইনপুট স্টাইলিং সরান */
            -webkit-appearance: none;
            cursor: pointer;
            background-color: #eaf6ff; /* হালকা নীল ইনপুট ব্যাকগ্রাউন্ড */
            color: #333;
        }
        .age-calculator-content .calculate-button {
            background-color: #007bff; /* নীল বোতাম */
            color: white;
            padding: 14px 25px; /* বর্ধিত প্যাডিং */
            border: none;
            border-radius: 10px;
            font-size: 1.15rem; /* বর্ধিত ফন্ট সাইজ */
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            width: 100%;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        .age-calculator-content .calculate-button:hover {
            background-color: #0056b3;
            transform: translateY(-1px);
        }
        .age-calculator-content .result-area {
            margin-top: 25px; /* বর্ধিত মার্জিন */
            padding: 20px; /* বর্ধিত প্যাডিং */
            background-color: #e6f7ff; /* ফলাফলের জন্য হালকা নীল ব্যাকগ্রাউন্ড */
            border-radius: 16px;
            border: 1px solid #b3e0ff;
            min-height: 80px; /* বর্ধিত উচ্চতা */
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.05);
        }
        .age-calculator-content .result-area p {
            font-size: 1.3rem; /* বর্ধিত ফন্ট সাইজ */
            color: #0056b3;
            font-weight: 700;
            margin: 5px 0; /* সামঞ্জস্যপূর্ণ মার্জিন */
        }
        .age-calculator-content .result-area .error-message {
            color: #d9534f; /* ত্রুটি বার্তার জন্য লাল */
            font-size: 1rem; /* বর্ধিত ফন্ট সাইজ */
            font-weight: 500;
        }

        /* তারিখ ও সময় ক্যালকুলেটর স্টাইল */
        .date-time-content {
            padding: 20px; /* বর্ধিত প্যাডিং */
            border-radius: 16px;
            margin: 0 auto;
            max-width: 450px; /* বর্ধিত প্রস্থ */
            background-color: #f8f9fa; /* হালকা ধূসর ব্যাকগ্রাউন্ড */
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
        }
        .date-time-content .button-group {
            display: flex;
            justify-content: space-around;
            gap: 10px; /* বর্ধিত ফাঁক */
            margin-bottom: 20px; /* বর্ধিত মার্জিন */
            flex-wrap: wrap;
        }
        .date-time-content .show-date-button {
            background-color: #007bff; /* নীল বোতাম */
            color: white;
            padding: 14px 25px; /* বর্ধিত প্যাডিং */
            border: none;
            border-radius: 10px;
            font-size: 1.15rem; /* বর্ধিত ফন্ট সাইজ */
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            flex: 1; /* বোতামগুলি সমান প্রস্থ নেবে */
            min-width: 160px; /* ছোট স্ক্রিনে মোড়ানোর জন্য */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        .date-time-content .show-date-button:hover {
            background-color: #0056b3;
            transform: translateY(-1px);
        }
        .date-time-content .result-area {
            margin-top: 25px; /* বর্ধিত মার্জিন */
            padding: 20px; /* বর্ধিত প্যাডিং */
            background-color: #e6f7ff; /* ফলাফলের জন্য হালকা নীল ব্যাকগ্রাউন্ড */
            border-radius: 16px;
            border: 1px solid #b3e0ff;
            min-height: 80px; /* বর্ধিত উচ্চতা */
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: flex-start; /* টেক্সট বামদিকে সারিবদ্ধ করুন */
            text-align: left; /* টেক্সট বামদিকে সারিবদ্ধ করুন */
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.05);
        }
        .date-time-content .result-area p {
            font-size: 1.05rem; /* বর্ধিত ফন্ট সাইজ */
            color: #333;
            font-weight: 500;
            margin: 5px 0; /* সামঞ্জস্যপূর্ণ মার্জিন */
        }
        .date-time-content .result-area strong {
            font-weight: 700;
            color: #0056b3;
        }
        .date-time-content .result-section-title {
            font-size: 1.3rem; /* বর্ধিত ফন্ট সাইজ */
            font-weight: 700;
            color: #0056b3;
            margin-top: 15px; /* বর্ধিত মার্জিন */
            margin-bottom: 10px; /* বর্ধিত মার্জিন */
            width: 100%;
            text-align: center;
        }
        .date-time-content .result-section-title:first-child {
            margin-top: 0;
        }
        .date-time-content .input-group input[type="date"] {
            padding: 12px; /* বর্ধিত প্যাডিং */
            border: 1px solid #cce7ff; /* হালকা নীল বর্ডার */
            border-radius: 10px;
            font-size: 1rem; /* বর্ধিত ফন্ট সাইজ */
            background-color: #eaf6ff; /* হালকা নীল ইনপুট ব্যাকগ্রাউন্ড */
            color: #333;
        }

        /* বৈজ্ঞানিক ক্যালকুলেটর স্টাইল */
        .scientific-calculator-content {
            padding: 20px; /* বর্ধিত প্যাডিং */
            border-radius: 20px; /* গোলাকার কোণ */
            background-color: #263238; /* গাঢ় ধূসর/নীল ক্যালকুলেটর ব্যাকগ্রাউন্ড */
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3); /* ছায়া */
            margin: 0 auto;
            max-width: 500px; /* বর্ধিত প্রস্থ */
        }
        .scientific-calculator-content .input-area {
            margin-bottom: 15px; /* বর্ধিত মার্জিন */
        }
        .scientific-calculator-content .expression-input {
            width: 100%;
            padding: 12px; /* প্যাডিং কমানো হয়েছে */
            font-size: 1.2rem; /* ফন্ট সাইজ কমানো হয়েছে */
            border: 1px solid #ccc;
            border-radius: 12px;
            box-sizing: border-box;
            margin-bottom: 10px; /* বর্ধিত মার্জিন */
            text-align: right;
            background-color: #1c262b;
            color: white;
            height: 55px; /* উচ্চতা কমানো হয়েছে */
            word-wrap: break-word; /* দীর্ঘ সংখ্যা ভাঙুন */
            word-break: break-all; /* দীর্ঘ সংখ্যা ভাঙুন */
        }
        .scientific-calculator-content .scientific-buttons-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr); /* 5 কলামে পরিবর্তিত */
            gap: 10px; /* বর্ধিত ফাঁক */
            margin-bottom: 15px; /* বর্ধিত মার্জিন */
        }
        .scientific-calculator-content .scientific-button {
            padding: 14px; /* বর্ধিত প্যাডিং */
            font-size: 1.1rem; /* বর্ধিত ফন্ট সাইজ */
            border: none;
            outline: none;
            background-color: #455a64; /* বোতামের ব্যাকগ্রাউন্ড (নীল-ধূসর) */
            color: white;
            border-radius: 10px;
            cursor: pointer;
            transition: background-color 0.2s ease, transform 0.1s ease;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        .scientific-calculator-content .scientific-button:hover {
            background-color: #546e7a;
            transform: translateY(-1px);
        }
        .scientific-calculator-content .scientific-button.operator-btn {
            background-color: #007bff; /* নীল অপারেটর */
        }
        .scientific-calculator-content .scientific-button.operator-btn:hover {
            background-color: #0056b3;
        }
        .scientific-calculator-content .scientific-button.clear-btn {
            background-color: #ef5350; /* লাল ক্লিয়ার */
            color: white;
        }
        .scientific-calculator-content .scientific-button.clear-btn:hover {
            background-color: #d32f2f;
        }
        .scientific-calculator-content .scientific-button.equals-btn {
            background-color: #007bff; /* ইকুয়ালস বোতামের রঙ (নীল) */
        }
        .scientific-calculator-content .scientific-button.equals-btn:hover {
            background-color: #0056b3;
        }
        .scientific-result { /* স্টাইলিংয়ের জন্য scientific-calculator-content এর বাইরে সরানো হয়েছে */
            margin-top: 20px; /* বর্ধিত মার্জিন */
            padding: 20px; /* বর্ধিত প্যাডিং */
            background-color: #e6f7ff;
            border-radius: 16px;
            border: 1px solid #b3e0ff;
            font-size: 1.6rem; /* বর্ধিত ফন্ট সাইজ */
            font-weight: 600;
            color: #0056b3;
            min-height: 65px; /* বর্ধিত উচ্চতা */
            display: flex;
            align-items: center;
            justify-content: flex-end;
            word-wrap: break-word;
            word-break: break-all;
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.05);
            margin-left: auto;
            margin-right: auto;
            max-width: 500px; /* scientific-calculator-content এর সর্বোচ্চ প্রস্থের সাথে সারিবদ্ধ করুন */
        }
        .error-message { /* স্টাইলিংয়ের জন্য scientific-calculator-content এর বাইরে সরানো হয়েছে */
            color: #d9534f;
            font-size: 1rem;
            font-weight: 500;
            margin-top: 10px;
            margin-left: auto;
            margin-right: auto;
            max-width: 500px; /* scientific-calculator-content এর সর্বোচ্চ প্রস্থের সাথে সারিবদ্ধ করুন */
        }


        /* সংবাদ বিভাগের স্টাইল */
        .news-content {
            padding: 20px; /* বর্ধিত প্যাডিং */
            border-radius: 16px;
            margin: 0 auto;
            max-width: 480px; /* বর্ধিত প্রস্থ */
            background-color: #f8f9fa; /* হালকা ধূসর ব্যাকগ্রাউন্ড */
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
        }
        .news-content .news-display-area {
            margin-top: 20px; /* বর্ধিত মার্জিন */
            padding: 20px; /* বর্ধিত প্যাডিং */
            background-color: #e6f7ff; /* হালকা নীল ব্যাকগ্রাউন্ড */
            border-radius: 16px;
            border: 1px solid #b3e0ff;
            min-height: 100px; /* বর্ধিত উচ্চতা */
            text-align: left;
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.05);
        }
        .news-content .news-display-area h3 {
            font-size: 1.4rem; /* বর্ধিত ফন্ট সাইজ */
            font-weight: 700;
            color: #0056b3;
            margin-bottom: 12px; /* বর্ধিত মার্জিন */
        }
        .news-content .news-display-area ul {
            list-style: none;
            padding: 0;
        }
        .news-content .news-display-area li {
            margin-bottom: 10px; /* বর্ধিত মার্জিন */
        }
        .news-content .news-display-area a {
            color: #007bff;
            text-decoration: none;
            font-size: 1.05rem; /* বর্ধিত ফন্ট সাইজ */
            transition: color 0.2s ease;
        }
        .news-content .news-display-area a:hover {
            color: #0056b3;
            text-decoration: underline;
        }
        .news-content .news-display-area .error-message {
            color: #d9534f;
            font-size: 1rem;
            font-weight: 500;
        }

        .bio-link-section {
            margin-top: 20px; /* বর্ধিত মার্জিন */
            text-align: center;
            padding-top: 15px; /* বর্ধিত প্যাডিং */
            border-top: 1px solid #e0e0e0;
        }

        .bio-link-section p {
            font-size: 1.05rem; /* বর্ধিত ফন্ট সাইজ */
            font-weight: 600;
            color: #333;
            margin-bottom: 10px; /* বর্ধিত মার্জিন */
        }


        /* ফন্ট কনভার্টার বিভাগের স্টাইল */
        .font-converter-content {
            padding: 40px; /* বডির সাথে মিলিয়ে প্যাডিং বাড়ানো হয়েছে */
            border-radius: 12px;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15); /* গভীর ছায়া */
            width: 100%;
            max-width: 1000px; /* দুটি কলামের জন্য সর্বোচ্চ প্রস্থ সামঞ্জস্য করা হয়েছে */
            display: flex;
            flex-direction: column;
            gap: 20px;
            background-color: #ffffff; /* কনভার্টার বিভাগের জন্য সাদা ব্যাকগ্রাউন্ড */
        }
        .font-converter-sections-wrapper {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        @media (min-width: 768px) {
            .font-converter-sections-wrapper {
                flex-direction: row;
            }
        }
        .font-converter-section {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        .font-section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 5px;
        }
        .font-section-header h2 {
            font-size: 1.5rem;
            font-weight: bold;
            color: #333;
            margin: 0;
        }
        .font-converter-content textarea {
            width: 100%;
            min-height: 200px;
            padding: 12px;
            border: 1px solid #cbd5e0;
            border-radius: 8px;
            font-size: 1rem;
            resize: vertical;
            box-sizing: border-box;
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
            color: #333; /* টেক্সটএরিয়া টেক্সট পঠনযোগ্য নিশ্চিত করুন */
        }
        /* ডানদিকের টেক্সটএরিয়ার জন্য লোড করা SutonnyMJ ফন্ট ব্যবহার করার স্টাইল */
        #textAreaRight {
            font-family: 'SUTONNYMJ', sans-serif;
            font-size: 1.5rem;
        }
        .font-converter-content textarea:focus {
            outline: none;
            border-color: #6366f1;
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.2);
        }
        .font-button-group {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
        }
        .font-converter-content button {
            color: white;
            border: none;
            cursor: pointer;
            font-weight: 700;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            z-index: 1;
        }
        .font-converter-content button:before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
            z-index: -1;
            transform: skewX(-20deg);
        }
        .font-converter-content button:hover:before {
            left: 100%;
        }
        .font-converter-content button:hover {
            transform: translateY(-3px);
        }
        .font-converter-content button:active {
            transform: translateY(0);
        }

        .font-conversion-button {
            background-image: linear-gradient(to right, #34d399 0%, #10b981 100%); /* সবুজ গ্রেডিয়েন্ট */
            padding: 15px 30px; /* বর্ধিত প্যাডিং */
            font-size: 1.05rem; /* সামান্য বড় ফন্ট */
            border-radius: 8px; /* আরও গোলাকার */
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1); /* উন্নত ছায়া */
        }
        .font-conversion-button:hover {
            background-image: linear-gradient(to right, #10b981 0%, #059669 100%); /* হোভারে গাঢ় সবুজ গ্রেডিয়েন্ট */
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
        }
        .font-conversion-button:active {
            background-image: linear-gradient(to right, #059669 0%, #047857 100%); /* সক্রিয় অবস্থায় আরও গাঢ় সবুজ */
            box-shadow: 0 1px 5px rgba(0, 0, 0, 0.1);
        }

        .font-copy-button {
            background-image: linear-gradient(to right, #34d399 0%, #10b981 100%); /* সবুজ গ্রেডিয়েন্ট */
            padding: 8px 15px; /* কপি বোতামের জন্য ছোট */
            font-size: 0.9rem;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        .font-copy-button:hover {
            background-image: linear-gradient(to right, #10b981 0%, #059669 100%); /* হোভারে গাঢ় সবুজ গ্রেডিয়েন্ট */
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
        }
        .font-copy-button:active {
            background-image: linear-gradient(to right, #059669 0%, #047857 100%); /* সক্রিয় অবস্থায় আরও গাঢ় সবুজ */
            transform: translateY(0);
            box-shadow: 0 1px 5px rgba(0, 0, 0, 0.1);
        }

        .font-undo-redo-button {
            background-image: linear-gradient(to right, #60a5fa 0%, #3b82f6 100%); /* নীল গ্রেডিয়েন্ট */
            padding: 10px 20px;
            font-size: 0.95rem;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        .font-undo-redo-button:hover {
            background-image: linear-gradient(to right, #3b82f6 0%, #2563eb 100%);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
        }
        .font-undo-redo-button:active {
            background-image: linear-gradient(to right, #2563eb 0%, #1d4ed8 100%);
            transform: translateY(0);
            box-shadow: 0 1px 5px rgba(0, 0, 0, 0.1);
        }
        .font-undo-redo-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: translateY(0);
            box-shadow: none;
        }

        .font-clear-button {
            background-image: linear-gradient(to right, #ef5350 0%, #d32f2f 100%); /* লাল গ্রেডিয়েন্ট */
            padding: 10px 20px;
            font-size: 0.95rem;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        .font-clear-button:hover {
            background-image: linear-gradient(to right, #d32f2f 0%, #c62828 100%);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
        }
        .font-clear-button:active {
            background-image: linear-gradient(to right, #c62828 0%, #b71c1c 100%);
            transform: translateY(0);
            box-shadow: 0 1px 5px rgba(0, 0, 0, 0.1);
        }

        .font-clear-all-button {
            background-image: linear-gradient(to right, #ef5350 0%, #d32f2f 100%); /* লাল গ্রেডিয়েন্ট */
            padding: 15px 30px;
            font-size: 1.05rem;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            width: 100%; /* পূর্ণ প্রস্থ জুড়ে বিস্তৃত করুন */
            margin-top: 20px; /* কিছু টপ মার্জিন যোগ করুন */
        }
        .font-clear-all-button:hover {
            background-image: linear-gradient(to right, #d32f2f 0%, #c62828 100%);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.15);
        }
        .font-clear-all-button:active {
            background-image: linear-gradient(to right, #c62828 0%, #b71c1c 100%);
            transform: translateY(0);
            box-shadow: 0 1px 5px rgba(0, 0, 0, 0.1);
        }


        .external-converter-link {
            display: block;
            margin-top: 20px; /* বর্ধিত মার্জিন */
            padding: 12px 18px; /* বর্ধিত প্যাডিং */
            background-color: #007bff;
            color: white;
            border-radius: 10px;
            text-decoration: none;
            font-size: 1.05rem; /* বর্ধিত ফন্ট সাইজ */
            font-weight: 600;
            transition: background-color 0.3s ease, transform 0.2s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            text-align: center; /* লিঙ্কের মধ্যে টেক্সট কেন্দ্র করুন */
        }
        .external-converter-link:hover {
            background-color: #0056b3;
            transform: translateY(-1px);
        }


 /* টেক্সট অ্যাসিস্ট্যান্ট (চ্যাট) বিভাগের নতুন স্টাইল */
.text-assistant-content {
    padding: 20px;
    border-radius: 16px;
    margin: 0 auto;
    max-width: 600px; /* চ্যাটের জন্য প্রস্থ বাড়ানো হয়েছে */
    background-color: #f8f9fa;
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
}
.chat-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
}
.chat-header h3 {
    font-size: 1.4rem;
    font-weight: 700;
    color: #333;
}
.clear-chat-button {
    background-color: #ef5350;
    color: white;
    padding: 6px 12px;
    border: none;
    border-radius: 8px;
    font-size: 0.9rem;
    cursor: pointer;
    transition: background-color 0.3s ease;
}
.clear-chat-button:hover {
    background-color: #d32f2f;
}
.chat-window {
    height: 400px;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
    gap: 12px;
    padding: 15px;
    background-color: #e6f7ff;
    border-radius: 16px;
    border: 1px solid #b3e0ff;
    margin-bottom: 15px;
}
.message {
    padding: 10px 15px;
    border-radius: 12px;
    max-width: 85%;
    word-wrap: break-word;
    white-space: pre-wrap;
    line-height: 1.6;
}
.user-message {
    background-color: #3f51b5;
    color: white;
    align-self: flex-end;
    border-bottom-right-radius: 2px;
}
.gemini-message {
    background-color: #ffffff;
    color: #333;
    align-self: flex-start;
    border-bottom-left-radius: 2px;
    box-shadow: 0 1px 2px rgba(0,0,0,0.05);
}
.gemini-error-message {
    background-color: #ffebee;
    color: #c62828;
    align-self: flex-start;
    border-bottom-left-radius: 2px;
}
.input-container {
    display: flex;
    gap: 10px;
    align-items: stretch; /* বোতাম এবং টেক্সটএরিয়া একই উচ্চতায় রাখুন */
}
.text-assistant-content textarea {
    flex-grow: 1;
    height: auto;
    min-height: 50px;
    padding: 12px;
    margin-bottom: 0;
    border: 1px solid #cce7ff;
    border-radius: 10px;
    font-size: 1rem;
    resize: vertical;
}
.text-assistant-content .ask-button {
    width: auto;
    margin-bottom: 0;
    flex-shrink: 0;
    background-color: #8A2BE2;
    color: white;
    padding: 10px 20px;
    border: none;
    border-radius: 10px;
    font-size: 1rem;
    cursor: pointer;
}
.text-assistant-content .loading-indicator {
    display: none;
    text-align: center;
    padding: 10px;
    font-size: 1rem;
    color: #555;
}

        /* কন্টেন্ট প্রাথমিকভাবে লুকানো */
        .calculator-content {
            display: none;
        }
        .calculator-content.active {
            display: block;
        }

        /* API কী মডেল স্টাইল */
        .api-key-modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6); /* গাঢ় ব্যাকগ্রাউন্ড */
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            backdrop-filter: blur(8px); /* ব্যাকগ্রাউন্ড ব্লার */
        }

        .api-key-modal-content {
            background-color: #ffffff;
            padding: 30px; /* বর্ধিত প্যাডিং */
            border-radius: 20px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3); /* গভীর ছায়া */
            max-width: 450px;
            width: 90%;
            text-align: center;
            transform: translateY(-30px); /* সামান্য উপর থেকে আসবে */
            animation: fadeInScale 0.4s ease-out forwards;
        }

        @keyframes fadeInScale {
            from {
                opacity: 0;
                transform: translateY(-30px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .api-key-modal-content h3 {
            font-size: 1.8rem; /* বর্ধিত ফন্ট সাইজ */
            font-weight: 700;
            color: #333;
            margin-bottom: 25px; /* বর্ধিত মার্জিন */
        }

        .api-key-modal-content input[type="text"] {
            width: 100%;
            padding: 15px; /* বর্ধিত প্যাডিং */
            margin-bottom: 20px; /* বর্ধিত মার্জিন */
            border: 1px solid #cce7ff; /* হালকা নীল বর্ডার */
            border-radius: 10px;
            font-size: 1.05rem;
            box-sizing: border-box;
            background-color: #eaf6ff; /* হালকা নীল ইনপুট ব্যাকগ্রাউন্ড */
            color: #333;
        }

        .api-key-modal-content .modal-buttons {
            display: flex;
            justify-content: space-around;
            gap: 15px; /* বর্ধিত ফাঁক */
        }

        .api-key-modal-content .modal-button {
            padding: 12px 25px; /* বর্ধিত প্যাডিং */
            border: none;
            border-radius: 10px;
            font-size: 1.05rem;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.2s ease;
            flex: 1;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .api-key-modal-content .modal-button.save {
            background-color: #28a745; /* সবুজ */
            color: white;
        }
        .api-key-modal-content .modal-button.save:hover {
            background-color: #218838;
            transform: translateY(-1px);
        }

        .api-key-modal-content .modal-button.cancel {
            background-color: #ef5350; /* লাল */
            color: white;
        }
        .api-key-modal-content .modal-button.cancel:hover {
            background-color: #d32f2f;
            transform: translateY(-1px);
        }

        .api-key-modal-content .message-area {
            margin-top: 20px; /* বর্ধিত মার্জিন */
            font-size: 1rem;
            font-weight: 500;
            min-height: 25px; /* বার্তা প্রদর্শনের জন্য ন্যূনতম উচ্চতা */
        }
        .api-key-modal-content .message-area.success {
            color: #28a745; /* সবুজ */
        }
        .api-key-modal-content .message-area.error {
            color: #d9534f; /* লাল */
        }


        /* ছোট স্ক্রিনের জন্য প্রতিক্রিয়াশীল সামঞ্জস্য */
        @media (max-width: 600px) {
            .main-container {
                padding: 15px;
                border-radius: 15px;
            }
            .tab-buttons {
                margin-bottom: 15px;
                gap: 6px;
            }
            .tab-button {
                padding: 8px 10px;
                font-size: 0.8rem;
                border-radius: 8px;
            }
            .calculator-grid {
                grid-template-columns: repeat(4, 1fr);
                grid-template-rows: minmax(80px, auto) repeat(5, 1fr);
                gap: 8px;
                padding: 15px;
                max-width: 320px;
            }
            .calculator-button {
                font-size: 1.4rem;
                border-radius: 8px;
            }
            .output {
                height: 80px;
                padding: 10px;
                border-radius: 10px;
            }
            .output .current-operand {
                font-size: 2.8rem;
            }
            .output .previous-operand {
                font-size: 1.3rem;
            }
            .explain-button {
                padding: 8px 15px;
                font-size: 0.9rem;
                border-radius: 8px;
            }
            .age-calculator-content,
            .date-time-content,
            .scientific-calculator-content,
            .news-content,
            .font-converter-content,
            .text-assistant-content {
                padding: 15px;
                border-radius: 12px;
            }
            .age-calculator-content .input-group label,
            .date-time-content .input-group label {
                font-size: 0.95rem;
            }
            .age-calculator-content .input-group input[type="date"],
            .date-time-content .input-group input[type="date"] {
                padding: 10px;
                font-size: 0.9rem;
                border-radius: 8px;
            }
            .age-calculator-content .calculate-button,
            .date-time-content .show-date-button {
                padding: 12px 20px;
                font-size: 1.05rem;
                border-radius: 8px;
            }
            .age-calculator-content .result-area p,
            .date-time-content .result-area p {
                font-size: 1rem;
            }
            .scientific-calculator-content .expression-input {
                font-size: 1.1rem; /* ছোট স্ক্রিনের জন্য ফন্ট সাইজ কমানো হয়েছে */
                padding: 10px; /* ছোট স্ক্রিনের জন্য প্যাডিং কমানো হয়েছে */
                height: 45px; /* ছোট স্ক্রিনের জন্য উচ্চতা কমানো হয়েছে */
                border-radius: 10px;
            }
            .scientific-button { /* বৈজ্ঞানিক বোতামের জন্য সামঞ্জস্যপূর্ণ */
                font-size: 0.9rem;
                padding: 10px;
                border-radius: 8px;
            }
            .scientific-result { /* বৈজ্ঞানিক ফলাফলের জন্য সামঞ্জস্যপূর্ণ */
                font-size: 1.4rem;
                padding: 15px;
                min-height: 55px;
                border-radius: 12px;
            }
            .news-content .news-display-area h3 {
                font-size: 1.3rem;
            }
            .news-content .news-display-area a {
                font-size: 0.95rem;
            }
            .font-converter-content textarea {
                height: 100px;
                font-size: 0.95rem;
                border-radius: 8px;
            }
            .font-converter-content .font-conversion-button { /* কনভার্টার বোতাম থেকে পরিবর্তিত */
                padding: 10px 15px;
                font-size: 0.95rem;
                min-width: 140px;
                border-radius: 8px;
            }
            .font-converter-content .font-copy-button { /* কনভার্টার বোতাম থেকে পরিবর্তিত */
                padding: 8px 12px;
                font-size: 0.85rem;
                border-radius: 8px;
            }
            .font-undo-redo-button {
                padding: 8px 12px;
                font-size: 0.85rem;
                border-radius: 8px;
            }
            .font-clear-button {
                padding: 8px 12px;
                font-size: 0.85rem;
                border-radius: 8px;
            }
            .font-clear-all-button {
                padding: 12px 20px;
                font-size: 0.95rem;
                border-radius: 8px;
            }
            .text-assistant-content textarea {
                height: 120px;
                font-size: 0.95rem;
                border-radius: 8px;
            }
            .text-assistant-content .ask-button {
                padding: 12px 20px;
                font-size: 1.05rem;
                border-radius: 8px;
            }
            .api-key-modal-content {
                padding: 20px;
                border-radius: 15px;
            }
            .api-key-modal-content h3 {
                font-size: 1.5rem;
            }
            .api-key-modal-content input[type="text"] {
                padding: 12px;
                font-size: 0.95rem;
                border-radius: 8px;
            }
            .api-key-modal-content .modal-button {
                padding: 10px 15px;
                font-size: 0.95rem;
                border-radius: 8px;
            }
        }
    </style>
</head>
<body>
    <div class="main-container">
        <h2 class="text-3xl font-bold text-gray-800 mb-8">কম্বাইন্ড ক্যালকুলেটর</h2>

        <div class="tab-buttons">
            <button id="basicCalcTab" class="tab-button active rounded-xl">সাধারণ ক্যালকুলেটর</button>
            <button id="ageCalcTab" class="tab-button rounded-xl">বয়স ক্যালকুলেটর</button>
            <button id="dateCalcTab" class="tab-button rounded-xl">তারিখ ও সময়</button>
            <button id="scientificCalcTab" class="tab-button rounded-xl">সাইন্টিফিক ক্যালকুলেটর</button>
            <button id="newsTab" class="tab-button rounded-xl">সাম্প্রতিক খবর</button>
            <button id="converterTab" class="tab-button rounded-xl">কনভার্টার</button>
            <button id="textAssistantTab" class="tab-button rounded-xl">টেক্সট অ্যাসিস্ট্যান্ট</button>
            <button id="allFeaturesTab" class="tab-button rounded-xl">সকল ফিচার</button>
            <button id="setApiKeyBtn" class="tab-button rounded-xl" style="background-color: #ef5350; color: white;">API কী সেট করুন</button>
        </div>

        <!-- মৌলিক ক্যালকুলেটর বিভাগ -->
        <div id="basicCalculatorContent" class="calculator-content active">
            <div class="calculator-grid">
                <div class="output">
                    <div data-previous-operand class="previous-operand"></div>
                    <div data-current-operand class="current-operand"></div>
                </div>
                <button data-all-clear class="clear calculator-button rounded-xl" style="grid-column: span 2;">AC</button>
                <button data-delete class="calculator-button rounded-xl">DEL</button>
                <button data-operator class="operator calculator-button rounded-xl">÷</button> <!-- ভাগ -->
                <button data-number class="calculator-button rounded-xl">7</button>
                <button data-number class="calculator-button rounded-xl">8</button>
                <button data-number class="calculator-button rounded-xl">9</button>
                <button data-operator class="operator calculator-button rounded-xl">×</button> <!-- গুণ -->
                <button data-number class="calculator-button rounded-xl">4</button>
                <button data-number class="calculator-button rounded-xl">5</button>
                <button data-number class="calculator-button rounded-xl">6</button>
                <button data-operator class="operator calculator-button rounded-xl">-</button> <!-- বিয়োগ -->
                <button data-number class="calculator-button rounded-xl">1</button>
                <button data-number class="calculator-button rounded-xl">2</button>
                <button data-number class="calculator-button rounded-xl">3</button>
                <button data-operator class="operator calculator-button rounded-xl">+</button> <!-- যোগ -->
                <button data-number class="zero calculator-button rounded-xl" style="grid-column: span 2;">0</button>
                <button data-number class="calculator-button rounded-xl">.</button>
                <button data-equals class="equals calculator-button rounded-xl">=</button> <!-- সমান -->
            </div>
            <!-- LLM-চালিত ব্যাখ্যা বৈশিষ্ট্য -->
            <button id="explainBasicBtn" class="explain-button rounded-xl">ব্যাখ্যা করুন ✨</button>
            <div id="basicExplanationLoading" class="loading-indicator">জেমিনি ব্যাখ্যা করছে</div>
            <div id="basicExplanation" class="response-area rounded-lg mt-4" style="background-color: #e6f7ff; border: 1px solid #b3e0ff;"></div>
        </div>

        <!-- বয়স ক্যালকুলেটর বিভাগ -->
        <div id="ageCalculatorContent" class="calculator-content">
            <div class="age-calculator-content">
                <div class="input-group">
                    <label for="birthDate">জন্ম তারিখ:</label>
                    <input type="date" id="birthDate" class="rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                </div>

                <div class="input-group">
                    <label for="currentDate">বর্তমান তারিখ:</label>
                    <input type="date" id="currentDate" class="rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                </div>

                <button id="calculateAgeBtn" class="calculate-button rounded-xl">বয়স গণনা করুন</button>

                <div id="ageResultArea" class="result-area">
                    <p id="ageResult" class="text-xl"></p>
                    <p id="ageErrorMessage" class="error-message"></p>
                </div>
            </div>
        </div>

        <!-- তারিখ ও সময় ক্যালকুলেটর বিভাগ -->
        <div id="dateCalculatorContent" class="calculator-content">
            <div class="date-time-content">
                <div class="button-group">
                    <button id="showTodayDatesBtn" class="show-date-button rounded-xl">আজকের তারিখ ও সময়</button>
                    <button id="showTomorrowDatesBtn" class="show-date-button rounded-xl">আগামীকালের তারিখ ও সময়</button>
                </div>
                <div id="dateDisplayResult" class="result-area">
                    <!-- আজকের তারিখের জন্য -->
                    <div id="todayResultSection">
                        <p class="result-section-title">আজকের তারিখ</p>
                        <p id="todayGregorianDateDisplay"></p>
                        <p id="todayBengaliDateDisplay"></p>
                        <p id="todayHijriDateDisplay"></p>
                        <p id="todayDayDisplay"></p> <!-- আজকের দিনের জন্য নতুন সারি -->
                        <p id="todayTimeDisplay"></p>
                    </div>

                    <!-- আগামীকালের তারিখের জন্য -->
                    <div id="tomorrowResultSection" style="display: none;">
                        <p class="result-section-title">আগামীকালের তারিখ</p>
                        <p id="tomorrowGregorianDateDisplay"></p>
                        <p id="tomorrowBengaliDateDisplay"></p>
                        <p id="tomorrowHijriDateDisplay"></p>
                        <p id="tomorrowDayDisplay"></p> <!-- আগামীকালের দিনের জন্য নতুন সারি -->
                        <p id="tomorrowTimeDisplay"></p>
                    </div>
                </div>

                <!-- ইংরেজি থেকে বাংলা তারিখ রূপান্তর বৈশিষ্ট্য -->
                <div class="input-group mt-6">
                    <label for="englishDateInput" class="text-gray-700 font-semibold text-left block mb-2">ইংরেজি তারিখ লিখুন:</label>
                    <input type="date" id="englishDateInput" class="rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent w-full p-2 border border-gray-300">
                </div>
                <button id="convertEnglishToBengaliBtn" class="show-date-button rounded-xl mt-4">বাংলা তারিখে রূপান্তর করুন</button>
                <div id="bengaliConvertedDateDisplay" class="result-area mt-4">
                    <p class="result-section-title">রূপান্তরিত বাংলা তারিখ</p>
                    <p id="convertedBengaliDate"></p>
                    <p id="convertedDayDisplay"></p> <!-- রূপান্তরিত দিনের জন্য নতুন সারি -->
                </div>
                <!-- নতুন বোতাম এবং লিংক -->
                <a href="https://ajkertarikh.com" target="_blank" class="show-date-button rounded-xl mt-4 block mx-auto text-center">প্রয়োজনে এখানে তারিখ দেখুন</a>
            </div>
        </div>

        <!-- বৈজ্ঞানিক ক্যালকুলেটর বিভাগ -->
        <div id="scientificCalculatorContent" class="calculator-content">
            <div class="scientific-calculator-content">
                <div class="input-area">
                    <input type="text" id="scientificExpressionInput" class="expression-input rounded-lg" placeholder="এক্সপ্রেশন লিখুন (যেমন: sin(90) + 2*3)">
                </div>
                <div class="scientific-buttons-grid">
                    <!-- সারি 1 -->
                    <button class="scientific-button clear-btn rounded-lg" data-sci-input="C" style="grid-column: span 2;">C</button>
                    <button class="scientific-button rounded-lg" data-sci-input="DEL">DEL</button>
                    <button class="scientific-button rounded-lg" data-sci-input="(">(</button>
                    <button class="scientific-button rounded-lg" data-sci-input=")">)</button>

                    <!-- সারি 2 (সংখ্যা 1-2-3) -->
                    <button class="scientific-button rounded-lg" data-sci-input="1">1</button>
                    <button class="scientific-button rounded-lg" data-sci-input="2">2</button>
                    <button class="scientific-button rounded-lg" data-sci-input="3">3</button>
                    <button class="scientific-button rounded-lg" data-sci-input="sin">sin</button>
                    <button class="scientific-button operator-btn rounded-lg" data-sci-input="÷">÷</button> <!-- ভাগ -->

                    <!-- সারি 3 (সংখ্যা 4-5-6) -->
                    <button class="scientific-button rounded-lg" data-sci-input="4">4</button>
                    <button class="scientific-button rounded-lg" data-sci-input="5">5</button>
                    <button class="scientific-button rounded-lg" data-sci-input="6">6</button>
                    <button class="scientific-button rounded-lg" data-sci-input="cos">cos</button>
                    <button class="scientific-button operator-btn rounded-lg" data-sci-input="×">×</button> <!-- গুণ -->

                    <!-- সারি 4 (সংখ্যা 7-8-9, tan, -) - পরিবর্তিত -->
                    <button class="scientific-button rounded-lg" data-sci-input="7">7</button>
                    <button class="scientific-button rounded-lg" data-sci-input="8">8</button>
                    <button class="scientific-button rounded-lg" data-sci-input="9">9</button>
                    <button class="scientific-button rounded-lg" data-sci-input="tan">tan</button> <!-- '7' এর পরিবর্তে 'tan' -->
                    <button class="scientific-button operator-btn rounded-lg" data-sci-input="-">-</button> <!-- '-' এখানে সরানো হয়েছে -->

                    <!-- সারি 5 (সংখ্যা 0 এবং অন্যান্য) -->
                    <button class="scientific-button rounded-lg" data-sci-input="0" style="grid-column: span 2;">0</button>
                    <button class="scientific-button rounded-lg" data-sci-input=".">.</button>
                    <button class="scientific-button rounded-lg" data-sci-input="π">π</button>
                    <button class="scientific-button operator-btn rounded-lg" data-sci-input="+">+</button> <!-- যোগ -->

                    <!-- সারি 6 (log, ln, sqrt, ^, =) -->
                    <button class="scientific-button rounded-lg" data-sci-input="log">log</button>
                    <button class="scientific-button rounded-lg" data-sci-input="ln">ln</button>
                    <button class="scientific-button rounded-lg" data-sci-input="sqrt">√</button>
                    <button class="scientific-button rounded-lg" data-sci-input="^">^</button>
                    <button class="scientific-button equals-btn rounded-lg" data-sci-equals style="grid-column: span 1;">=</button> <!-- সমান -->

                </div>
            </div>
            <!-- scientific-calculator-content এর বাইরে সরানো হয়েছে -->
            <div id="scientificResult" class="scientific-result rounded-lg"></div>
            <div id="scientificErrorMessage" class="error-message"></div>
            <!-- LLM-চালিত ব্যাখ্যা বৈশিষ্ট্য -->
            <button id="explainScientificBtn" class="explain-button rounded-xl">ব্যাখ্যা করুন ✨</button>
            <div id="scientificExplanationLoading" class="loading-indicator">জেমিনি ব্যাখ্যা করছে</div>
            <div id="scientificExplanation" class="response-area rounded-lg mt-4" style="background-color: #e6f7ff; border: 1px solid #b3e0ff;"></div>
        </div>

        <!-- সাম্প্রতিক সংবাদ বিভাগ -->
        <div id="newsContent" class="calculator-content">
            <div class="news-content"> <!-- সাধারণ কন্টেন্ট প্রদর্শনের জন্য news-content স্টাইলিং পুনরায় ব্যবহার করা হচ্ছে -->
                <div id="newsDisplayArea" class="news-display-area rounded-lg">
                    <h3>বাংলাদেশের প্রধান দৈনিক পত্রিকা</h3>
                    <ul id="newsHeadlinesList">
                        <li><a href="https://www.bd-pratidin.com/" target="_blank">বাংলাদেশ প্রতিদিন</a></li>
                        <li><a href="https://www.dhakapost.com/" target="_blank">ঢাকাপোস্ট</a></li>
                        <li><a href="https://www.kalerkantho.com/" target="_blank">কালের কণ্ঠ</a></li>
                        <li><a href="https://www.ittefaq.com.bd/" target="_blank">দৈনিক ইত্তেফাক</a></li>
                        <li><a href="https://www.dailyamardesh.com/" target="_blank">আমার দেশ</a></li>
                    </ul>
                    <div class="bio-link-section">
                        <p>প্রয়োজনে ভিজিট করুন</p>
                        <a href="https://bio.link/mdsifatbiolink" target="_blank" class="text-blue-600 hover:underline font-semibold text-lg">bio.link/mdsifatbiolink</a>
                    </div>
                    <div id="newsErrorMessage" class="error-message"></div>
                </div>
            </div>
        </div>

        <!-- ফন্ট কনভার্টার বিভাগ (আনডু/রিডু সহ আপডেট করা হয়েছে) -->
        <div id="converterContent" class="calculator-content">
		<h1 style="color:green">যেকোনো ভাঙ্গা বিজয় লেখা ইউনিকোড করে আবার বিজয়ে কনভার্ট করলে ঠিক হয়ে যাবে।</h1>
            <div class="font-converter-content">
                <div class="font-converter-sections-wrapper">
                    <!-- বাম টেক্সটএরিয়া -->
                    <div class="font-converter-section">
                        <div class="font-section-header">
                            <h2>ইউনিকোড টেক্সট</h2>
                            <button class="font-copy-button rounded-lg" onclick="copyToClipboard('textAreaLeft')">কপি করুন</button>
                        </div>
                        <textarea id="textAreaLeft" placeholder="এখানে ইউনিকোড টেক্সট লিখুন"></textarea>
                        <div class="font-button-group">
                            <button class="font-conversion-button rounded-lg" onclick="convertLeftToRight()">ইউনিকোড থেকে বিজয়</button>
                            <button id="undoButtonLeft" class="font-undo-redo-button rounded-lg" onclick="undoText('textAreaLeft')">আনডু</button>
                            <button id="redoButtonLeft" class="font-undo-redo-button rounded-lg" onclick="redoText('textAreaLeft')">রিডু</button>
                            <button class="font-clear-button rounded-lg" onclick="clearTextarea('textAreaLeft')">মুছুন</button>
                        </div>
                    </div>
                    <!-- ডান টেক্সটএরিয়া -->
                    <div class="font-converter-section">
                        <div class="font-section-header">
                            <h2>বিজয় টেক্সট</h2>
                            <button class="font-copy-button rounded-lg" onclick="copyToClipboard('textAreaRight')">কপি করুন</button>
                        </div>
                        <textarea id="textAreaRight" placeholder="এখানে বিজয় টেক্সট লিখুন"></textarea>
                        <div class="font-button-group">
                            <button class="font-conversion-button rounded-lg" onclick="convertRightToLeft()">বিজয় থেকে ইউনিকোড</button>
                            <button id="undoButtonRight" class="font-undo-redo-button rounded-lg" onclick="undoText('textAreaRight')">আনডু</button>
                            <button id="redoButtonRight" class="font-undo-redo-button rounded-lg" onclick="redoText('textAreaRight')">রিডু</button>
                            <button class="font-clear-button rounded-lg" onclick="clearTextarea('textAreaRight')">মুছুন</button>
                        </div>
                    </div>
                </div>
                <!-- নতুন "সব মুছুন" বোতাম -->
                <button class="font-clear-all-button rounded-lg" onclick="clearAllTextareas()">সব মুছুন</button>
                <a href="https://bangla.plus/bijoy-unicode-converter" target="_blank" class="external-converter-link rounded-xl">প্রয়োজনে এখান থেকে কনভার্ট করুন</a>
            </div>
        </div>

<!-- টেক্সট অ্যাসিস্ট্যান্ট (চ্যাট) বিভাগ -->
<div id="textAssistantContent" class="calculator-content">
    <div class="text-assistant-content">
        <div class="chat-header">
            <h3>জেমিনির সাথে চ্যাট করুন</h3>
            <button id="clearChatBtn" class="clear-chat-button">চ্যাট মুছুন</button>
        </div>
        <div id="chatWindow" class="chat-window">
            <!-- চ্যাট বার্তা এখানে যুক্ত করা হবে -->
        </div>
        <div id="assistantLoading" class="loading-indicator">জেমিনি চিন্তা করছে...</div>
        <div class="input-container">
            <textarea id="assistantInput" placeholder="এখানে আপনার প্রশ্ন লিখুন..."></textarea>
            <button id="askGeminiBtn" class="ask-button">পাঠান</button>
        </div>
    </div>
</div>

        <!-- সকল ফিচার বিভাগ -->
        <div id="allFeaturesContent" class="calculator-content">
            <div class="news-content"> <!-- সাধারণ কন্টেন্ট প্রদর্শনের জন্য news-content স্টাইলিং পুনরায় ব্যবহার করা হচ্ছে -->
                <div id="featuresDisplayArea" class="news-display-area rounded-lg">
                    <h3>এই অ্যাপের সকল ফিচার</h3>
                    <ul class="list-disc pl-5 text-left">
                        <li class="mb-2">
                            <strong class="text-blue-700">সাধারণ ক্যালকুলেটর:</strong> মৌলিক গাণিতিক অপারেশন (যোগ, বিয়োগ, গুণ, ভাগ) সম্পাদন করুন।
                            <ul class="list-circle pl-4 mt-1 text-gray-700">
                                <li>সংখ্যা এবং অপারেটর ব্যবহার করে গণনা।</li>
                                <li>কীবোর্ড ইনপুট সমর্থন।</li>
                                <li><strong class="text-purple-700">জেমিনি চালিত ব্যাখ্যা:</strong> আপনার ইনপুট করা গাণিতিক এক্সপ্রেশন বা ফাংশনের সহজ ব্যাখ্যা পান।</li>
                            </ul>
                        </li>
                        <li class="mb-2">
                            <strong class="text-blue-700">বয়স ক্যালকুলেটর:</strong> আপনার জন্ম তারিখ এবং বর্তমান তারিখের উপর ভিত্তি করে আপনার সঠিক বয়স (বছর, মাস, দিন) গণনা করুন।
                        </li>
                        <li class="mb-2">
                            <strong class="text-blue-700">তারিখ ও সময় ক্যালকুলেটর:</strong> আজকের এবং আগামীকালের গ্রেগরিয়ান, বাংলা ও হিজরি তারিখ এবং বর্তমান সময় দেখুন।
                            <ul class="list-circle pl-4 mt-1 text-gray-700">
                                <li>ইংরেজি তারিখ থেকে বাংলা তারিখে রূপান্তর করার নতুন ফিচার।</li>
                                <li>তারিখের সাথে বারের নামও প্রদর্শিত হবে।</li>
                            </ul>
                        </li>
                        <li class="mb-2">
                            <strong class="text-blue-700">সাইন্টিফিক ক্যালকুলেটর:</strong> জটিল গাণিতিক এক্সপ্রেশন এবং ফাংশন (যেমন: sin, cos, tan, log, ln, sqrt, power) গণনা করুন।
                            <ul class="list-circle pl-4 mt-1 text-gray-700">
                                <li>বিভিন্ন গাণিতিক ফাংশন এবং ধ্রুবক (π, e) ব্যবহার করুন।</li>
                                <li><strong class="text-purple-700">জেমিনি চালিত ব্যাখ্যা:</strong> আপনার ইনপুট করা গাণিতিক এক্সপ্রেশন বা ফাংশনের সহজ ব্যাখ্যা পান।</li>
                            </ul>
                        </li>
                        <li class="mb-2">
                            <strong class="text-blue-700">সাম্প্রতিক খবর:</strong> বাংলাদেশের প্রধান দৈনিক পত্রিকাগুলির সরাসরি লিংক পান।
                            <ul class="list-circle pl-4 mt-1 text-gray-700">
                                <li>বাংলাদেশ প্রতিদিন, ঢাকাপোস্ট, কালের কণ্ঠ, দৈনিক ইত্তেফাক, আমার দেশ।</li>
                                <li>প্রয়োজনীয় বিভিন্ন লিংক পেতে <a href="https://bio.link/mdsifatbiolink" target="_blank" class="text-blue-600 hover:underline">bio.link/mdsifatbiolink</a> ভিজিট করুন।</li>
                            </ul>
                        </li>
                        <li class="mb-2">
                            <strong class="text-blue-700">কনভার্টার:</strong> ইউনিকোড এবং বিজয় আনসি ফন্টের মধ্যে টেক্সট রূপান্তর করুন।
                            <ul class="list-circle pl-4 mt-1 text-gray-700">
                                <li>ইউনিকোড থেকে বিজয় আনসি এবং বিজয় আনসি থেকে ইউনিকোডে রূপান্তর।</li>
                                <li><strong class="text-purple-700">আনডু/রিডু ফিচার:</strong> টেক্সট ইনপুটের ইতিহাস সংরক্ষণ এবং পূর্বাবস্থায় ফিরিয়ে আনা বা পুনরায় করার সুবিধা।</li>
                                <li>বাহিরের কনভার্টার লিংকের জন্য: <a href="https://bangla.plus/bijoy-unicode-converter" target="_blank" class="text-blue-600 hover:underline">bangla.plus/bijoy-unicode-converter</a>।</li>
                            </ul>
                        </li>
                        <li class="mb-2">
                            <strong class="text-blue-700">টেক্সট অ্যাসিস্ট্যান্ট (জেমিনি চালিত):</strong> জেমিনি এপিআই ব্যবহার করে যেকোনো প্রশ্নের উত্তর পান, লেখা সারসংক্ষেপ করুন, বা অন্যান্য টেক্সট-ভিত্তিক সহায়তা নিন।
                        </li>
                    </ul>
                </div>
            </div>
        </div>

    </div>

    <!-- API কী মডেল -->
    <div id="apiKeyModal" class="api-key-modal-overlay hidden">
        <div class="api-key-modal-content">
            <h3>জেমিনি API কী সেট করুন</h3>
            <input type="text" id="apiKeyInput" placeholder="আপনার API কী এখানে লিখুন..." class="rounded-lg">
            <div class="modal-buttons">
                <button id="saveApiKeyBtn" class="modal-button save rounded-lg">সেভ করুন</button>
                <button id="cancelApiKeyBtn" class="modal-button cancel rounded-lg">বাতিল করুন</button>
            </div>
            <div id="apiKeyMessage" class="message-area"></div>
        </div>
    </div>

    <script>
        // ইউনিকোড থেকে বিজয় রূপান্তরের জন্য ম্যাপিং
        const unicodeToBijoyMap = {
            // স্বরবর্ণ সেকশন
            "অ": "A",        "আ": "Av",       "ই": "B",        "ঈ": "C",        "উ": "D",        "ঊ": "E",        "ঋ": "F",        "এ": "G",        "ঐ": "H",        "ও": "I",
            "ঔ": "J",

            // ব্যাঞ্জনবর্ণ সেকশন
            "ক": "K",        "খ": "L",        "গ": "M",        "ঘ": "N",        "ঙ": "O",        "চ": "P",        "ছ": "Q",        "জ": "R",        "ঝ": "S",        "ঞ": "T",
            "ট": "U",        "ঠ": "V",        "ড": "W",        "ঢ": "X",        "ণ": "Y",        "ত": "Z",        "থ": "_",        "দ": "`",        "ধ": "a",        "ন": "b",
            "প": "c",        "ফ": "d",        "ব": "e",        "ভ": "f",        "ম": "g",        "য": "h",        "র": "i",        "ল": "j",        "শ": "k",        "ষ": "l",
            "স": "m",        "হ": "n",        "ড়": "o",        "ঢ়": "p",        "য়": "q",        "ৎ": "r",        "ং": "s",        "ঃ": "t",        "ঁ": "u",        "ৰ": "v", "ড়": "o",        "ঢ়": "p",        "য়": "q",
             "র্বৃ": "e„©",       "ৱ": "w",     "ড়ে": "‡o",        "ঢ়ে": "‡p",        "য়ে": "‡q",   "ড়ৈ": "‰o",        "ঢ়ৈ": "‰p",        "য়ৈ": "‰q",    "ড়ি": "wo",        "ঢ়ি": "wp",        "য়ি": "wq",

            // নম্বর সেকশন
            "০": "0",        "১": "1",        "২": "2",        "৩": "3",        "৪": "4",        "৫": "5",        "৬": "6",        "৭": "7",        "৮": "8",        "৯": "9",
            "৳": "৳",        "₹": "₹",

            // কার চিহ্ন সেকশন
            "া": "v",        "ি": "w",        "ী": "x",        "ু": "y",        "ূ": "~",        "ৃ": "„",

            // ফলা সেকশন
            "্র": "ª",        "্য": "¨",        "র্": "©",	"¦": " ্ব",

            // ওকার ঔকার সেকশন
            "ে": "‡",        "ৈ": "‰",        "ো": "‡v",       "ৌ": "‡Š",       "ৗ": "Š",

            // জয়েনার সেকশন
            "্": "&",

            // বিবিধ
            "।": "|",        "॥": "||",       "‘": "Ô",        "’": "Õ",        "“": "Ò",        "”": "Ó",        "৷": "৷",        "৥": "৥",

            // যুক্তবর্ণ সেকশন
            "ক্ক": "°",      "ক্ট": "±",      "ক্ত": "³",      "ক্ব": "K¡",     "ক্র": "µ",   "ক্লি": "wK¬",    "ক্ল": "K¬",     "ক্ষ": "¶",      "ক্স": "·",      "খ্র": "Lª",     "গ্দ": "M&`",
            "গ্ধ": "»",      "গ্ন": "Mœ",     "গ্ম": "M¥",     "গ্র": "MÖ",     "গ্ল": "Mø",     "ঙ্ক": "¼",      "ঙ্খ": "•L",     "ঙ্গ": "½",      "ঙ্ঘ": "•N",     "চ্চ": "”P",
            "চ্ছ": "”Q",     "জ্জ": "¾",      "জ্ঝ": "À",      "জ্ঞ": "Á",      "জ্ব": "R¡",     "জ্র": "Rª",     "ঞ্চ": "Â",      "ঞ্ছ": "Ã",      "ঞ্জ": "Ä",	"ন্ব": "š^",
            "ঞ্ঝ": "Å",      "ট্ট": "Æ",      "ট্ব": "U¡",     "ট্ম": "U¥",     "ট্র": "Uª",     "ড্ড": "Ç",      "ড্র": "Wª",     "ঢ্র": "Xª",     "ণ্ট": "È",		"ত্ব": "Z¡",
            "ণ্ঠ": "É",      "ণ্ড": "Ð",      "ণ্ণ": "Yœ",     "ত্ত": "Ë",      "ত্থ": "Ì",      "ত্ন": "Zœ",     "ত্ম": "Z¥",     "ত্র": "Î",      "দ্দ": "Ï",		"ঙ্ম": "•g",	
            "দ্ধ": "×",      "দ্ব": "Ø",      "দ্ভ": "™¢",     "দ্ম": "Ù",      "দ্র": "`ª",     "ধ্ব": "aŸ",     "ধ্ম": "a¥",     "ন্ত": "šÍ",     "ন্থ": "š’",	"ক্ম": "´",
            "ন্দ": "›`",     "ন্ধ": "Ü",      "ন্ন": "bœ",     "ন্ম": "b¥",     "প্ট": "Þ",      "প্ত": "ß",      "প্ন": "cœ",     "প্প": "à",      "প্র": "cÖ",		"ক্ষ্ণ": "ÿè",
            "প্ল": "cø",     "প্স": "á",      "ফ্র": "d«",     "ফ্ল": "d¬",     "ব্জ": "â",      "ব্দ": "ã",      "ব্ধ": "ä",      "ব্ব": "eŸ",     "ব্র": "eª",	"গ্গ": "¹",
            "ব্ল": "eø",     "ভ্র": "å",      "ম্ন": "gœ",     "ম্ফ": "ç",      "ম্ব": "¤^",     "ম্ভ": "¤¢",     "ম্ম": "¤§",     "ম্র": "gª",     "ম্ল": "¤ø",	 "থ্ব": "_¡",
            "ল্ক": "é",      "ল্গ": "ê",      "ল্ট": "ë",      "ল্ড": "ì",      "ল্প": "í",      "ল্ব": "j¦",     "ল্ম": "j¥",     "ল্ল": "jø",     "শ্চ": "ð",	 "দ্দ্ব": "Ï¡",
            "শ্ন": "kœ",     "শ্ব": "k¦",     "শ্ম": "k¥",     "শ্ল": "kø",     "ষ্ক": "®‹",     "ষ্ট": "ó",      "ষ্ঠ": "ô",      "ষ্ণ": "ò",      "ষ্প": "®ú",	 "ন্ত্ব": "šÍ¡",
            "ষ্ফ": "õ",      "ষ্ম": "®§",     "স্ক": "¯‹",     "স্খ": "ö",      "স্ট": "÷",      "স্ত": "¯Í",     "স্থ": "¯’",     "স্ন": "mœ",     "স্প": "¯ú",	 "স্রূ": "¯ªƒ",
            "স্ফ": "ù",      "স্ব": "¯^",     "স্ম": "¯§",     "স্ল": "¯ø",     "হ্ণ": "nè",     "হ্ন": "ý",      "হ্ম": "þ",      "হ্ল": "n¬",     "হু": "û",		
            "হৃ": "ü",      "গু": "¸",      "শু": "ï",      "ক্ত্র": "³ª",     "ক্ন": "Kè",     "ক্ষ্ণ": "òœ",     "ক্ষ্ম": "²",      "ক্ষ্র": "ÿ«",     "গ্ব": "M&e",
            "ঘ্ন": "Nœ",     "ঘ্র": "Nª",     "ঙ্গু": "½y",     "জ্জ্ব": "¾¡",   "ত্ত্ব": "Ë¡",     "ত্রু": "Îæ",     "দ্রু": "`ªæ",    "ভ্রু": "åæ",     "শ্রু": "kÖæ",
            "ম্প": "¤ú",     "্র্য": "ª‍¨",    "র‌্য": "i¨",     "ক্য": "K¨",     "ল্যু": "j¨y",    "ক্লু": "K¬z",    "ত্র্য": "Î¨",     "স্থ্য": "¯’¨",    "দ্য": "`¨",
            "ক্য": "K¨",     "ভ্য": "f¨",     "ল্য": "j¨", 	"দ্যু": "`y¨",     "ম্য": "g¨",     "ন্য": "b¨",     "ণ্য": "Y¨",     "কার্য": "Kvh©",   "র্ষ": "l©",       "র্য": "h©",		
		"ব্যু": "ey¨",   "ত্ব": "Z¡",	"হ্ব": "nŸ",	"গ্নু": "Mœy",	"র্ু": "z©",       "৳": "$",      "র্ষূ": "l~©",        "র্ষু": "ly©",    "–": "-","৷": "|",
        };

        // বিজয় থেকে ইউনিকোড রূপান্তরের জন্য ম্যাপিং
        const bijoyToUnicodeMap = {
            // স্বরবর্ণ সেকশন
            "A": "অ",        "Av": "আ",       "B": "ই",        "C": "ঈ",        "D": "উ",        "E": "ঊ",        "F": "ঋ",        "G": "এ",        "H": "ঐ",        "I": "ও",
            "J": "ঔ",

            // *** সংশোধিত অংশ শুরু ***
            "†": "ে", // 'এ' এর পরিবর্তে 'ে' (e-kar)
            "ˆ": "ৈ", // 'ঐ' এর পরিবর্তে 'ৈ' (oi-kar)
            // *** সংশোধিত অংশ শেষ ***
			"‡": "ে", // 'এ' এর পরিবর্তে 'ে' (e-kar)
            "‰": "ৈ",
            // ব্যাঞ্জনবর্ণ সেকশন
            "K": "ক",        "L": "খ",        "M": "গ",        "N": "ঘ",        "O": "ঙ",        "P": "চ",        "Q": "ছ",        "R": "জ",        "S": "ঝ",        "T": "ঞ",
            "U": "ট",        "V": "ঠ",        "W": "ড",        "X": "ঢ",        "Y": "ণ",        "Z": "ত",        "_": "থ",        "`": "দ",        "a": "ধ",        "b": "ন",
            "c": "প",        "d": "ফ",        "e": "ব",        "f": "ভ",        "g": "ম",        "h": "য",        "i": "র",        "j": "ল",        "k": "শ",        "l": "ষ",
            "m": "স",        "n": "হ",        "o": "ড়",        "p": "ঢ়",        "q": "য়",        "r": "ৎ",        "s": "ং",        "t": "ঃ",        "u": "ঁ",

            // নম্বর সেকশন
            "0": "০",        "1": "১",        "2": "২",        "3": "৩",        "4": "৪",        "5": "৫",        "6": "৬",        "7": "৭",        "8": "৮",        "9": "৯",
            "৳": "৳",

            // কার চিহ্ন সেকশন
            "v": "া",        "w": "ি",        "x": "ী",        "y": "ু",        "~": "ূ",        "„": "ৃ",		"‡v": "ো", 	"z": "ু", 	"†v": "ো",		"†Š": "ৌ", 	"‡Š": "ৌ",

            // ফলা সেকশন
            "ª": "্র",        "¨": "্য",        "©": "র্", 	"Ö": "্র",

            // ওকার ঔকার সেকশন
            "‡": "ে",        "‰": "ৈ",        "Š": "ৗ",

            // জয়েনার সেকশন
            "&": "্",

            // বিবিধ
            "|": "।",        "||": "॥",       "Ô": "‘",        "Õ": "’",        "Ò": "“",        "Ó": "”",        " ": " ",        ".": ".",        ",": ",",        "-": "-",
            "?": "?",        "!": "!",        "'": "'",        "(": "(",        ")": ")",	"iæ": "রু",	"eªæ": "ব্রু", 	"Zz": "তু",	"nŸ": "হ্ব",

            // যুক্তবর্ণ সেকশন
            "°": "ক্ক",      "±": "ক্ট",      "³": "ক্ত",      "K¡": "ক্ব",     "µ": "ক্র",  "wK¬": "ক্লি",     "K¬": "ক্ল",     "¶": "ক্ষ",      "·": "ক্স",      "Lª": "খ্র",     "M&`": "গ্দ",
            "»": "গ্ধ",      "Mœ": "গ্ন",     "M¥": "গ্ম",     "MÖ": "গ্র",     "Mø": "গ্ল",     "¼": "ঙ্ক",      "•L": "ঙ্খ",     "½": "ঙ্গ",      "•N": "ঙ্ঘ",     "”P": "চ্চ",
            "”Q": "চ্ছ",     "¾": "জ্জ",      "À": "জ্ঝ",      "Á": "জ্ঞ",      "R¡": "জ্ব",     "Rª": "জ্র",     "Â": "ঞ্চ",      "Ã": "ঞ্ছ",      "Ä": "ঞ্জ",	"cÖæ": "প্রু",
            "Å": "ঞ্ঝ",      "Æ": "ট্ট",      "U¡": "ট্ব",     "U¥": "ট্ম",     "Uª": "ট্র",     "Ç": "ড্ড",      "Wª": "ড্র",     "Xª": "ঢ্র",     "È": "ণ্ট",	"MÖæ": "গ্রু",
            "É": "ণ্ঠ",      "Ð": "ণ্ড",      "Yœ": "ণ্ণ",     "Ë": "ত্ত",      "Ì": "ত্থ",      "Zœ": "ত্ন",     "Z¥": "ত্ম",     "Î": "ত্র",      "Ï": "দ্দ",	"¯ª": "স্র",
            "×": "দ্ধ",      "Ø": "দ্ব",      "™¢": "দ্ভ",     "Ù": "দ্ম",      "`ª": "দ্র",     "aŸ": "ধ্ব",     "a¥": "ধ্ম",     "šÍ": "ন্ত",     "š’": "ন্থ",   "e„©": "র্বৃ",
            "›`": "ন্দ",     "Ü": "ন্ধ",      "bœ": "ন্ন",     "b¥": "ন্ম",     "Þ": "প্ট",      "ß": "প্ত",      "cœ": "প্ন",     "à": "প্প",      "cÖ": "প্র", 	"¤œ": "ম্ন",
            "cø": "প্ল",     "á": "প্স",      "d«": "ফ্র",     "d¬": "ফ্ল",     "â": "ব্জ",      "ã": "ব্দ",      "ä": "ব্ধ",      "eŸ": "ব্ব",     "eª": "ব্র",	 "´": "ক্ম",
            "eø": "ব্ল",     "å": "ভ্র",      "gœ": "ম্ন",     "ç": "ম্ফ",      "¤^": "ম্ব",     "¤¢": "ম্ভ",     "¤§": "ম্ম",     "gª": "ম্র",     "¤ø": "ম্ল",		"ÿè": "ক্ষ্ন",
            "é": "ল্ক",      "ê": "ল্গ",      "ë": "ল্ট",      "ì": "ল্ড",      "í": "ল্প",      "j¦": "ল্ব",     "j¥": "ল্ম",     "jø": "ল্ল",     "ð": "শ্চ",		"ÿ&Y": "ক্ষ্ণ",
            "kœ": "শ্ন",     "k¦": "শ্ব",     "k¥": "শ্ম",     "kø": "শ্ল",     "®‹": "ষ্ক",     "ó": "ষ্ট",      "ô": "ষ্ঠ",      "ò": "ষ্ণ",      "®ú": "ষ্প",		"¹": "গ্গ",
            "õ": "ষ্ফ",      "®§": "ষ্ম",     "¯‹": "স্ক",     "ö": "স্খ",      "÷": "স্ট",      "¯Í": "স্ত",     "¯’": "স্থ",     "mœ": "স্ন",     "¯ú": "স্প",	"M&M": "গ্গ",
            "ù": "স্ফ",      "¯^": "স্ব",     "¯§": "স্ম",     "¯ø": "স্ল",     "nè": "হ্ণ",     "ý": "হ্ন",      "þ": "হ্ম",      "n¬": "হ্ল",     "û": "হু",	"_¡": "থ্ব",
            "ü": "হৃ",      "¸": "গু",      "ï": "শু",      "³ª": "ক্ত্র",     "Kè": "ক্ন",     "òœ": "ক্ষ্ণ",     "²": "ক্ষ্ম",      "ÿ«": "ক্ষ্র",     "M&e": "গ্ব",	"Ï¡": "দ্দ্ব",
            "Nœ": "ঘ্ন",     "Nª": "ঘ্র",     "½y": "ঙ্গু",     "¾¡": "জ্জ্ব",   "Ë¡": "ত্ত্ব",     "Îæ": "ত্রু",     "`ªæ": "দ্রু",     "åæ": "ভ্রু",     "kÖæ": "শ্রু",	"šÍ¡": "ন্ত্ব",
            "¤ú": "ম্প",     "ª‍¨": "্র্য",    "i¨": "র‌্য",     "K¨": "ক্য",     "j¨y": "ল্যু",    "K¬z": "ক্লু",    "Î¨": "ত্র্য",     "¯’¨": "স্থ্য",    "`¨": "দ্য",	"gø": "ম্ল",
            "f¨": "ভ্য",     "j¨": "ল্য",     "g¨": "ম্য",     "b¨": "ন্য",     "Y¨": "ণ্য",     "Kv¨": "ক্যা",      "l©": "র্ষ",	"ÿ": "ক্ষ",		"åƒ": "ভ্রূ",	"¯ªƒ": "স্রূ",
		"Z¡": "ত্ব",	"Û": "ন্ড",	"š¿": "ন্ত্র",    "z©": "র্ু", 	"y¨": "্যু",      "©…": "র্ৃ",     "z©": "র্ু",   "z©": "র্ু",    "‚©": "র্ূ",  "•ÿ": "ঙ্ক্ষ", "b¦": "ন্ব",	"¯cø": "স্প্ল",
		"~¨": "্যূ",   "z¨": "্যু",        "‚¨": "্যূ",  	"Kz©¨": "র্্যু",   "K‚©¨": "র্্যূ",  "³": "ক্ত",       "¯‘": "স্তু", 	"¯¿": "স্ত্র", 	"vu": "াঁ", 	"œ": "্ন",	"¼Í": "ঙ্ক্ত",
		"uv": "াঁ",	 "›Uª": "ন্ট্র",     "n«": "হ্র",	    "š‘": "ন্তু",	    "Z…": "তৃ",	    "K…": "কৃ",	    "P‚": "চূ",	    "f‚": "ভূ",	    "iƒ": "রূ",	  "¦": "্ব",
		"›U": "ন্ট",	    "«": "্র",	    "…": "ৃ",	    "‚": "ূ", 	     "æ": "ু",      "Ý": "ন্স",      "š^": "ন্ব",    "ly©": "র্ষু",	 "l~©": "র্ষূ", "MÖƒ": "গ্রূ", "cÖƒ": "প্রূ", 
			"eªƒ": "ব্রূ", "kÖƒ": "শ্রূ",	"_¦": "থ্ব", "˜M": "দ্গ", "˜N": "দ্ঘ", "Ï": "দ্দ", "$": "৳", "K¥": "ক্ম", "òœ": "ক্ষ্ণ", "M&M": "গ্গ", "º": "গ্দ", "˜M": "দ্গ", "O¥": "ঙ্ম", "”T": "চ্ঞ", 
"Y&X": "ণ্ঢ", "Y¥": "ণ্ম", "Zø": "ত্ল", "Îƒ": "ত্রূ", "_¦": "থ্ব", "_ø": "থ্ল", "™£": "দ্ভ্র", "`ªƒ": "দ্রূ", "Ú": "ন্ঠ", "šÍ¦": "ন্ত্ব", "š’": "ন্থ", "åƒ": "ভ্রূ", "fø": "ভ্ল", "¤£": "ম্ভ্র", "¤ø": "ম্ল",
"î": "ল্ফ", "ñ": "শ্ছ", "®Œ": "ষ্ক্র", "¯Œ": "স্ক্র", "¯’": "স্থ", "¯ª~": "স্রূ", "¯ø": "স্ল", "—M": "ড়্গ", "aªƒ": "ধ্রূ", "¯úø": "স্প্ল", "¤úø": "ম্প্ল", "•g": "ঙ্ম", 	"mø": "স্ল", "¯": "্স", "f‚©": "র্ভূ", "fz©": "র্ভু", 
			};
        // ====================================================================
        // ম্যানুয়াল আনসি (বিজয়) রিপ্লেসমেন্ট ম্যাপ
        // ইউনিকোড থেকে বিজয় কনভার্সনের পর নির্দিষ্ট ভুল সংশোধনের জন্য ব্যবহৃত হয়।
        // ফরম্যাট: "ভুল স্ট্রিং": "সঠিক স্ট্রিং"
        const manualAnsiReplacements = {
            // নিচেরগুলোর মতো ম্যানুয়ালী বসাতে হবে সিকুয়েন্স, যদি আন্সিতে কোনো ভুল আউটপুট আসে।
            // ভবিষ্যতে আরও রিপ্লেসমেন্ট নিয়ম এখানে যোগ করুন
            "GZ‡": "G‡Z", // "এতে" GZ‡ কে G‡Z দিয়ে প্রতিস্থাপন করা হয়েছে, আন্সিতে ভুল আউটপুট এখানে এভাবে অ্যাড করতে হবে, আন্সি ভুল টু আন্সি সঠিক
			"‡ga¨": "g‡a¨",      "Ëw": "wË",       "P&P": "”P",      "¨y": "y¨",       "©„": "©…",        "—": "-",        "ów": "wó",
			"+‡": "+†",        "+‰": "+ˆ",       "vu": "uv",       "xu": "ux",       "Šu": "uŠ",      "`¨y": "`y¨",     "f©w": "wf©",     "³w": "w³",       "_©w": "w_©",
			"Mœw": "wMœ",       "K¬w": "wK¬",      "¯’w": "w¯’",      "Ô‡": "Ô†",       "Ò‡": "Ò†",      "-‡": "-†",       "(‡": "(†",       "Ô‰": "Ôˆ", // Corrected from "ˆ"
			"Ò‰": "Òˆ",        "-‰": "-ˆ",       "(‰": "ˆ",       "¶y": "ÿz",       "ww¯’Z": "w¯’wZ",      "cz©": "c©y",     "‡‡": "‡",        "††": "†",	"©z": "z©",
			"‰‰": "‰",         "ˆˆ": "ˆ",        "yy": "y",        "~~": "~",        "©©": "©",       "„„": "„",        "&&": "&",        "ªª": "ª",        "ŠŠ": "Š",
			"/‡": "/†",        "/‰": "(ˆ",       "=‡": "=†",       "=‰": "=ˆ",       "[‡": "[†",      "[‰": "[ˆ",      "{‡": "{†",       "{‰": "{ˆ",       " ‡": " †",
			" ‰": " ˆ",        " Ó": " Ò",      " Õ": " Ô",      "&;": "Ê",        "&|": "\\",      "&~": "E",        "&„": "F",        "&‡": "G",        "&‰": "H",
			"&b": "œ",         "&e": "¦",        "&g": "¥",        "&I": "I",        "&I&h": "I¨",    "&I&i": "Iª",     "&j": "ø",        "&Ô": "“",        "&Š": "J",
			"&v": "Av",        "&w": "B",        "&x": "C",        "&y": "D",        "&Z": "Í",        "(A)i": "(A)i",  "_&_": "Ì",       "_&e": "_¡",       "_&h": "_¨",
			"_&i": "_ª",        "_ª": "_ª",        "_u_": "Ì",       "`&`": "Ï",       "`&a": "×",       "`&e": "Ø",        "`&f": "™¢",      "`&g": "Ù",        "`&h": "`¨",
			"`&i": "`ª",        "`&M": "˜M",       "`&N": "˜N",       "`ª": "`ª",       "`ª~": "`ªƒ",      "`ªy": "`ªæ",      "¯’~": "¯’‚",      "¯’„": "¯’…",      "¯’y": "¯’z",
			"¯‹&i": "¯Œ",       "¯‹&iæ": "¯Œz",   "¯‹&j": "¯‹¬",    "¯‹~": "¯‹‚",      "¯‹„": "¯‹…",      "¯‹¬y": "¯‹¬z",   "¯‹ª": "¯Œ",      "¯‹y": "¯‹z",      "¯Í&e": "¯Í¡",
			"¯Í&i": "¯¿",       "¯Í~": "¯Í‚",      "¯Í„": "¯Í…",      "¯Íª": "¯¿",       "¯Íy": "¯‘",      "¯Œ~": "¯Œ‚",      "¯Œ„": "¯Œ…",      "¯Œy": "¯Œz",      "¯ú&j": "¯úø",
			"˜M&y": "`&¸",      "”P~": "”P‚",      "”P„": "”P…",      "”Py": "”Pz",      "”Q&e": "”Q¡",    "”Q~": "”Q‚",      "”Q„": "”Q…",      "”Qª": "”Q«",      "”Qy": "”Qz",
			"”T~": "”T‚",      "”T„": "”T…",      "”Ty": "”Tz",      "›`&e": "›Ø",     "›`ª~": "›`ªƒ",   "›`ªy": "›`ªæ",   "›U~": "›U‚",      "›U„": "›U…",      "›Uy": "›Uz",
			"¤¢&i": "¤£",      "¤¢ª": "¤£",      "¤ú&i": "¤úª",    "¤ú&j": "¤úø",    "±~": "±‚",       "±„": "±…",       "±y": "±z",       "»~": "»‚",       "»„": "»…",
			"»y": "»z",        "×~": "×‚",       "×„": "×…",       "×y": "×z",       "÷~": "÷‚",      "÷„": "÷…",       "÷y": "÷z",       "®‹~": "®‹‚",      "®‹„": "®‹…",
			"®‹ª": "®Œ",       "®‹y": "®‹z",      "®Œ~": "®Œ‚",      "®Œ„": "®Œ„",      "®Œy": "®Œz",      "®úª": "®úÖ",    "®úª~": "®úÖƒ",   "®úªy": "®úÖæ",   "°~": "°‚",
			"°„": "°…",        "°y": "°z",        "µ~": "µ‚",       "µ„": "µ…",       "µy": "µz",       "•ÿ~": "•ÿ‚",      "•ÿ„": "•ÿ…",      "•ÿy": "•ÿz",      "¼&l": "•ÿ",
			"¼~": "¼‚",        "¼„": "¼…",       "¼«~": "¼«‚",      "¼«„": "¼«…",      "¼«y": "¼«z",      "¼ª": "¼«",       "¼y": "¼z",       "¾&e": "¾¡",      "³~": "³‚",
			"³„": "³…",        "³ª": "³«",       "³y": "³z",       "a&e": "aŸ",       "a&g": "a¥",       "a&h": "a¨",       "A&h": "A¨",       "a&i": "aª",       "A&i": "Aª",
			"Á~": "Á‚",        "À~": "À‚",       "ä~": "ä‚",       "Ã~": "Ã‚",       "å~": "åƒ",       "Â‚": "Â‚",       "Á„": "Á…",       "À„": "À…",       "ä„": "ä…",
			"Ã„": "Ã…",        "Â…": "Â…",       "aª": "aª",       "Aª": "Aª",       "aª~": "aªƒ",      "aªy": "aªæ",      "Æ~": "Æ‚",       "Æ„": "Æ…",       "Æy": "Æz",
			"Av&h": "Av¨",     "Av&i": "Avª",    "Avª": "Avª",      "Áy": "Áz",       "Ây": "Âz",       "äy": "äz",       "Ãy": "Ãz",       "åy": "åæ",       "Àz": "Àz",
			"b&_": "š’",       "b&`": "›`",      "b&a": "Ü",       "b&b": "bœ",       "b&e": "š^",       "b&g": "b¥",       "b&h": "b¨",       "B&h": "B¨",       "b&i": "bª",
			"B&i": "Bª",        "b&m": "Ý",        "b&U": "›U",      "b&V": "Ú",       "b&W": "Û",       "b&Z": "šÍ",      "b&Z&i": "š¿",    "b&Zª": "š¿",      "bª": "bª",
			"Bª": "Bª",         "c&b": "cœ",       "c&c": "à",       "c&h": "c¨",       "C&h": "C¨",       "c&i": "cÖ",       "C&i": "Cª",       "c&j": "cø",       "c&m": "á",
			"c&U": "Þ",        "c&Z": "ß",       "ç~": "ç‚",       "Ç~": "Ç‚",       "ç„": "ç…",       "Ç„": "Ç…",       "cª": "cÖ",       "Cª": "Cª",       "cª~": "cÖƒ",
			"cªy": "cÖæ",      "cÖ~": "cÖƒ",      "cÖy": "cÖæ",      "çy": "çz",       "Çy": "Çz",       "d&h": "d¨",       "d&i": "d«",       "D&i": "Dª",       "d&j": "d¬",
			"d~": "d‚",        "ð~": "ð‚",       "Ð~": "Ð‚",       "d„": "d…",       "ð„": "ð…",       "Ð„": "Ð…",       "d«~": "d«‚",      "d«„": "d«…",      "d«y": "d«z",
			"d¬~": "d¬‚",      "d¬„": "d¬„",      "d¬y": "d¬z",      "dª": "d«",       "dy": "dz",       "ðy": "ðz",       "Ðy": "Ðz",       "e&`": "ã",       "e&a": "ä",
			"e&e": "eŸ",       "Ë&e": "Ë¡",      "e&h": "e¨",       "e&i": "eª",       "E&i": "Eª",       "e&j": "eø",       "e&R": "â",       "é~": "é‚",       "É~": "É‚",
			"È~": "È‚",        "ë~": "ë‚",      "Ë~": "Ë‚",       "é„": "é…",       "É„": "É…",       "È„": "È…",       "ë„": "ë…",       "Ë„": "Ë…",       "eª": "eª",
			"eª~": "eªƒ",      "eªy": "eªæ",      "éy": "éz",       "Éy": "Éz",       "Èy": "Èz",       "ëy": "ëz",       "Ëy": "Ëz",       "f&h": "f¨",       "F&h": "F¨",
			"f&i": "å",        "F&i": "Fª",       "f&j": "fø",      "f~": "f‚",       "f„": "f…",       "fª": "å",        "Fª": "Fª",       "fª~": "åƒ",      "fªy": "åæ",
			"fy": "fz",        "g&b": "¤œ",       "g&c": "¤ú",      "g&d": "ç",       "g&e": "¤^",       "g&f": "¤¢",       "g&f&i": "¤£",    "g&fª": "¤£",      "g&g": "¤§",
			"g&h": "g¨",       "G&h": "G¨",       "g&i": "¤ª",      "G&i": "Î",       "g&j": "¤ø",       "gª": "¤ª",       "Gª": "Gª",       "h&h": "h¨",       "H&h": "H¨",
			"h&i": "hª",       "H&i": "Hª",       "hª": "hª",       "Hª": "Hª",       "i&&I": "I©",     "i&_": "_©",       "i&`": "`©",      "i&a": "a©",       "i&A": "A©",
			"i&Av": "Av©",     "i&b": "b©",       "i&B": "B©",       "i&c": "c©",       "i&C": "C©",       "i&d": "d©",       "i&D": "D©",       "i&e": "e©",       "i&E": "E©",
			"i&f": "f©",       "i&F": "F©",       "i&g": "g©",       "i&G": "G©",       "i&h": "h©",       "i&H": "H©",       "i&i": "iª",       "i&I": "I©",       "I&i": "Iª",
			"i&j": "j©",       "i&J": "J©",       "i&k": "k©",       "i&K": "K©",       "i&l": "l©",       "i&L": "L©",       "i&m": "m©",       "i&M": "M©",       "i&n": "n©",
			"i&N": "N©",       "i&o": "o©",       "i&O": "O©",       "i&p": "p©",       "i&P": "P©",       "i&q": "q©",       "i&Q": "Q©",       "i&R": "R©",       "i&S": "S©",
			"i&T": "T©",       "i&U": "U©",       "i&V": "V©",       "i&W": "W©",       "i&X": "X©",       "i&Y": "Y©",       "i&Z": "Z©",       "i~": "iƒ",        "î~": "î~",
			"Î~": "Îƒ",       "î„": "î…",       "iª": "iª",        "Iª": "Iª",        "îª": "î«",       "iy": "iæ",        "îy": "îz",        "Îy": "Îæ",       "j&c": "í",
			"j&d": "î",        "j&d&i": "î«",     "j&dª": "î«",      "j&e": "j¦",       "j&g": "j¥",       "j&h": "j¨",       "J&h": "J¨",       "j&i": "jª",       "j&j": "jø",
			"j&K": "é",        "j&M": "ê",        "j&U": "ë",       "j&W": "ì",        "jª": "jª",        "Jª": "Jª",        "k&b": "kœ",       "K&b": "Kè",       "k&e": "k¦",
			"K&e": "K¡",       "k&g": "k¥",       "K&g": "´",        "k&h": "k¨",       "K&h": "K¨",       "k&i": "kÖ",       "K&i": "µ",        "K&j": "K¬",       "K&K": "°",
			"K&l": "ÿ",        "K&m": "·",        "k&P": "ð",       "k&Q": "ñ",        "K&U": "±",       "K&Z": "³",       "K&Zª": "³«",      "K~": "K‚",        "K„": "K…",
			"K¬~": "K¬‚",      "K¬„": "K¬…",      "K¬y": "K¬z",      "kª": "kÖ",       "Kª": "µ",        "kª~": "kÖƒ",      "Kª~": "µ’",      "kªy": "kÖæ",      "Kªy": "µ",
			"Kè~": "Kè‚",      "Kè„": "Kè…",      "Kèy": "Kèz",      "kÖ~": "kÖƒ",      "kÖy": "kÖæ",      "ky": "ï",        "Ky": "Kz",        "l&c": "®ú",      "l&d": "õ",
			"l&g": "®§",       "l&h": "l¨",       "L&h": "L¨",       "l&i": "lª",       "L&i": "Lª",       "l&K": "®‹",       "l&U": "ó",       "l&V": "ô",       "l&Y": "ò",
			"lª": "lª",        "Lª": "Lª",        "Lª~": "Lªƒ",      "Lªy": "Lªæ",      "m&_": "¯’",       "M&`": "º",       "M&a": "»",       "m&b": "¯œ",       "M&b": "Mœ",
			"m&c": "¯ú",       "m&d": "ù",        "m&e": "¯^",       "M&e": "M¦",       "m&g": "¯§",       "M&g": "M¥",       "m&h": "m¨",       "M&h": "M¨",       "m&i": "¯ª",
			"M&i": "MÖ",       "m&j": "¯ø",       "M&j": "Mø",       "m&K": "¯‹",       "m&K&i": "¯Œ",     "m&K&iy": "¯Œz",  "m&Kª": "¯Œ",      "m&Kªy": "¯Œz",    "m&L": "ö",
			"m&U": "÷",        "m&Z": "¯Í",      "mª": "¯ª",       "Mª": "MÖ",       "Mª~": "MÖƒ",      "Mªy": "MÖæ",      "MÖ~": "MÖƒ",      "MÖy": "MÖæ",      "My": "¸",
			"n&b": "ý",        "N&b": "Nœ",       "n&e": "nŸ",       "n&e2": "n¡",     "n&g": "þ",        "n&h": "n¨",       "N&h": "N¨",       "n&i": "n«",       "N&i": "Nª",
			"n&j": "n¬",       "n&Y": "nè",       "ñ~": "ñ‚",       "n„": "ü",        "ñ„": "ñ…",       "nª": "n«",       "Nª": "Nª",       "Nª~": "Nªƒ",      "Nªy": "Nªæ",
			"ny": "û",         "ñy": "ñz",        "O&g": "•g",       "o&h": "o¨",       "O&h": "O¨",       "o&i": "oª",       "O&i": "Oª",       "O&K": "¼",       "O&L": "•L",
			"o&M": "—M",       "O&M": "½",        "O&N": "•N",       "O~": "O‚",        "ó~": "ó‚",       "ò~": "ò‚",       "ô~": "ô‚",       "õ~": "õ‚",       "O„": "O…",
			"ó„": "ó…",        "ò„": "ò…",       "ô„": "ô…",       "õ„": "õ…",       "oª": "oª",       "Oª": "Oª",       "oy": "o–",       "Oy": "Oz",        "óy": "óz",
			"òy": "òz",        "ôy": "ôz",       "õy": "õz",       "p&h": "p¨",       "P&h": "P¨",       "p&i": "pª",       "P&i": "Pª",       "P&P": "”P",       "P&Q": "”Q",
			"P&T": "”T",       "P~": "P‚",        "P„": "P…",       "pª": "pª",       "Pª": "Pª",       "Puv": "Pvu",      "Py": "Pz",        "q&h": "q¨",       "Q&h": "Q¨",
			"q&i": "qª",       "Q&i": "Q«",       "Q~": "Q‚",        "Q„": "Q…",       "qª": "qª",       "Qª": "Q«",       "Qy": "Qz",        "R&e": "R¡",       "R&h": "R¨",
			"R&i": "Rª",       "R&R": "¾",        "R&S": "À",        "R&T": "Á",       "Rª": "Rª",       "rª\t": "rª",     "S&h": "S¨",       "S&i": "Sª",       "S~": "S‚",
			"š’~": "š’‚",      "š’„": "š’…",      "š’y": "š’z",      "S„": "S…",       "sª": "sª",       "Sª": "Sª",       "šÍ&i": "š¿",     "šÍ~": "šÍ‚",      "šÍ„": "šÍ…",
			"šÍª": "š¿",       "šÍy": "š‘",       "ß~": "ß‚",       "ß„": "ß…",       "ßy": "ßz",       "Sy": "Sz",        "T&h": "T¨",       "T&i": "Tª",       "T&P": "Â",
			"T&Q": "Ã",        "T&R": "Ä",        "T&S": "Å",        "T~": "T‚",        "T„": "T…",       "tª": "tª",       "Tª": "Tª",       "þ~": "þ~",        "Þ~": "Þ‚",
			"þ„": "þ„",        "Þ„": "Þ…",       "þy": "þz",       "Þy": "Þz",       "Ty": "Tz",        "™¢~": "™¢‚",      "™¢„": "™¢…",      "™¢ª": "™£",      "™¢y": "™¢z",
			"™£~": "™£ƒ",      "™£y": "™£æ",      "U&e": "U¡",       "U&g": "U¥",       "U&h": "U¨",       "U&i": "Uª",       "U&U": "Æ",       "U~": "U‚",        "Ú~": "Ú‚",
			"ù~": "ù‚",        "Û~": "Û‚",       "Ü~": "Ü‚",       "U„": "U…",       "Ú„": "Ú…",       "ù„": "ù…",       "Û„": "Û…",       "Ü„": "Ü…",       "ù«~": "ù«‚",
			"Ü«~": "Ü«‚",      "Ü«„": "Ü«…",      "ù«y": "ù«z",      "Ü«y": "Ü«z",      "Uª": "Uª",       "ùª": "ù«",       "Üª": "Ü«",       "uŠ": "Šu",        "ux": "xu",
			"uy": "yu",        "Uy": "Uz",        "Úy": "Úz",       "ùy": "ùz",       "Ûy": "Ûz",       "Üy": "Üz",       "V&h": "V¨",       "V&i": "Vª",       "V~": "V‚",
			"V„": "V…",        "Vª": "Vª",        "Vy": "Vz",        "W&h": "W¨",       "W&i": "Wª",       "W&W": "Ç",       "W~": "W‚",        "W„": "W…",       "Wª": "Wª",
			"Wy": "Wz",        "X&h": "X¨",       "X&i": "Xª",       "X~": "X‚",        "X„": "X…",       "Xª": "Xª",       "Xy": "Xz",        "Y&b": "Yœ",       "ÿ&b": "ÿè",
			"Y&e": "Y¦",       "ÿ&g": "²",        "Y&h": "Y¨",       "Y&i": "Yª",       "Y&U": "È",       "Y&V": "É",       "Y&W": "Ð",       "ÿ~": "ÿ‚",         "ÿ„": "ÿ…",
			"Yª": "Yª",        "ÿè~": "ÿè‚",      "ÿè„": "ÿè…",      "ÿèy": "ÿèz",      "ÿy": "ÿz",       "Z&_": "Ì",       "Z&b": "Zœ",       "Z&e": "Z¡",          "Z&g": "Z¥",
			"Z&h": "Z¨",       "Z&i": "Î",        "Z&Z": "Ë",       "Z~": "Z‚",        "Z„": "Z…",       "Zª": "Î",        "Zª~": "Îƒ",          "Zªy": "Îæ",           "Zy": "Zz",
			"|‡": "|†",			",‡": ",†",			".‡": ".†",			"-‡": "-†",			"?‡": "?†",		":‡": ":†",			"=‡": "=†",			"|‰": "|ˆ",	     "K©~": "K‚©",		",‰": ",ˆ",		"f¨~": "f‚¨",	"f©~": "f‚©",
			".‰": ".ˆ",			"-‰": "-ˆ",			"?‰": "?ˆ",			":‰": ":ˆ",			"=‰": "=ˆ",   "wwK¬": "wK¬w",	"e©…": "e„©",	   "e¨~": "e~¨",      "P©~": "P‚©Ó",    "P©y": "Pz©",     "K©y" :"Kz©", "f©y": "fz©",

        };

        // ম্যানুয়াল ইউনিকোড রিপ্লেসমেন্ট ম্যাপ (নতুন সেকশন)
        // বিজয় থেকে ইউনিকোড কনভার্সনের পর নির্দিষ্ট ভুল সংশোধনের জন্য ব্যবহৃত হয়।
        // ফরম্যাট: "ভুল স্ট্রিং": "সঠিক স্ট্রিং"
        const manualUnicodeReplacements = {
            // "ভুল ইউনিকোড": "সঠিক ইউনিকোড",
            // উদাহরণ: "উদাহরণ": "উদাহরণ" 
			"": "",
			"মধে্য": "মধ্যে",
			"র্নিভূল": "নির্ভূল",
			"র্নিভুল": "নির্ভুল",
        };
        // ====================================================================


        // দীর্ঘতম থেকে ছোট ক্রমে কীগুলি সাজান যাতে দীর্ঘ ক্রমগুলি প্রথমে হ্যান্ডেল করা যায়
        const sortedUnicodeKeys = Object.keys(unicodeToBijoyMap).sort((a, b) => b.length - a.length);
        const sortedBijoyKeys = Object.keys(bijoyToUnicodeMap).sort((a, b) => b.length - a.length);

        function convertLeftToRight() {
            const textAreaLeft = document.getElementById('textAreaLeft');
            const textAreaRight = document.getElementById('textAreaRight');
            let unicodeInput = textAreaLeft ? textAreaLeft.value : '';

            // --- ক্যারেক্টার ডেফিনিশন ---
            const bengaliConsonants = 'কখগঘঙচছজঝঞটঠডঢণতথদধনপফবভমযরলশষসহড়ঢ়য়';
            const unicodeIkar = '\u09BF'; // ি
            const unicodeEkar = '\u09C7'; // ে
            const unicodeOikar = '\u09C8'; // ৈ
            const unicodeOkar = '\u09CB'; // ো
            const unicodeOukar = '\u09CC'; // ৌ
            const unicodeAkar = '\u09BE'; // া
            const unicodeOuKarPart2 = '\u09D7'; // ৗ
            const unicodeHasanta = '\u09CD'; // ্
            const unicodeRefChar = '\u09B0\u09CD'; // র্ (র + হসন্ত)
            const unicodeJaPhala = '\u09CD\u09AF'; // ্য (হসন্ত + য)
            const unicodeRaPhala = '\u09CD\u09B0'; // ্র (হসন্ত + র)

            // --- প্রি-প্রসেসিং ধাপ ---

            // ধাপ ১: ও-কার এবং ঔ-কারকে তাদের উপাদান অংশে বিভক্ত করুন
            // এটি করা হয় যাতে 'ে' কারকে সঠিকভাবে আগে আনা যায়।
            // যেমন: কো -> ক + ে + া
            const consonantOrConjunct = `(?:(?:[${bengaliConsonants}]${unicodeHasanta})+[${bengaliConsonants}]|[${bengaliConsonants}])`;
            const o_ou_kar_regex = new RegExp(`(${consonantOrConjunct})(${unicodeOkar}|${unicodeOukar})`, 'g');
            unicodeInput = unicodeInput.replace(o_ou_kar_regex, (match, base, vowelSign) => {
                if (vowelSign === unicodeOkar) return base + unicodeEkar + unicodeAkar;
                if (vowelSign === unicodeOukar) return base + unicodeEkar + unicodeOuKarPart2;
                return match;
            });

            // ধাপ ২: বিজয় লেআউটের জন্য কার-চিহ্ন (ি, ে, ৈ) আগে আনুন
            // এই অংশটি রেফ, র-ফলা, য-ফলা সহ সকল যুক্তবর্ণের জন্য কাজ করবে।
            // যেমন: ক + ি -> ি + ক
            // যেমন: র্ + ক + ি -> ি + র্ + ক
            // যেমন: ক + ্র + ি -> ি + ক + ্র
            const precedingVowelRegex = new RegExp(`(${unicodeRefChar})?(${consonantOrConjunct})((?:${unicodeJaPhala}|${unicodeRaPhala})?)(${unicodeIkar}|${unicodeEkar}|${unicodeOikar})`, 'g');
            unicodeInput = unicodeInput.replace(precedingVowelRegex, (match, reph, base, phala, vowel) => {
                return vowel + (reph || '') + base + (phala || '');
            });
            
            // ধাপ ৩: মূল কনভার্সন লুপ
            let bijoyOutput = '';
            let k = 0;
            while (k < unicodeInput.length) {
                let foundMatch = false;

                // রেফ ('র্') এর জন্য বিশেষ হ্যান্ডলিং (যাতে © চিহ্নটি সঠিক জায়গায় বসে)
                if (unicodeInput.substring(k, k + 2) === unicodeRefChar) {
                    let baseCluster = '';
                    let clusterLen = 0;
                    // রেফের পরে দীর্ঘতম যুক্তবর্ণটি খুঁজুন
                    for (const key of sortedUnicodeKeys) {
                        if (key.length > 0 && unicodeInput.substring(k + 2, k + 2 + key.length) === key) {
                            baseCluster = key;
                            clusterLen = key.length;
                            break;
                        }
                    }
                    
                    if (clusterLen > 0) {
                        bijoyOutput += unicodeToBijoyMap[baseCluster] + '©';
                        k += 2 + clusterLen;
                        foundMatch = true;
                    }
                }

                // সাধারণ ম্যাপিং
                if (!foundMatch) {
                    for (const key of sortedUnicodeKeys) {
                        if (key.length > 0 && unicodeInput.substring(k, k + key.length) === key) {
                            bijoyOutput += unicodeToBijoyMap[key];
                            k += key.length;
                            foundMatch = true;
                            break;
                        }
                    }
                }

                // যদি কোনো ম্যাচ না পাওয়া যায়
                if (!foundMatch) {
                    bijoyOutput += unicodeInput[k];
                    k++;
                }
            }

            // ধাপ ৪: ম্যানুয়াল আনসি রিপ্লেসমেন্ট প্রয়োগ
            for (const [wrong, correct] of Object.entries(manualAnsiReplacements)) {
                if (wrong) { // খালি কী এড়িয়ে চলুন
                    const regex = new RegExp(wrong.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'g');
                    bijoyOutput = bijoyOutput.replace(regex, correct);
                }
            }

            // ধাপ ৫: ব্যবহারকারীর অনুরোধ অনুযায়ী অতিরিক্ত রিপ্লেসমেন্ট (লাইনের শুরু এবং দাড়ির পর)
            // এটি শব্দের শুরুতে ভুল কার-চিহ্নকে সঠিক স্বরবর্ণে পরিবর্তন করে।
            // যেমন, একটি লাইন 'ে' (‡) দিয়ে শুরু হতে পারে না, এটি 'এ' (†) হওয়া উচিত।
            bijoyOutput = bijoyOutput.replace(/^‡/gm, '†'); // লাইনের শুরুতে
            bijoyOutput = bijoyOutput.replace(/\|‡/g, '|†');   // দাড়ির পরে

            // একই নিয়ম 'ৈ' (‰) এর ক্ষেত্রেও প্রযোজ্য, যা 'ঐ' (ˆ) হওয়া উচিত।
            bijoyOutput = bijoyOutput.replace(/^‰/gm, 'ˆ'); // লাইনের শুরুতে
            bijoyOutput = bijoyOutput.replace(/\|‰/g, '|ˆ');   // দাড়ির পরে

            if (textAreaRight) {
                textAreaRight.value = bijoyOutput;
                addState('textAreaRight');
            }
        }

        // ====================================================================
        // START: CORRECTED FUNCTION
        // ====================================================================
        function convertRightToLeft() {
            const textAreaLeft = document.getElementById('textAreaLeft');
            const textAreaRight = document.getElementById('textAreaRight');
            let bijoyInput = textAreaRight ? textAreaRight.value : '';

            // --- ধাপ ১: বিজয় থেকে ইউনিকোড ম্যাপিং ---
            // প্রথমে, বিজয় স্ট্রিংটিকে ইউনিকোড ক্যারেক্টারে ম্যাপ করুন।
            let unicodeOutput = '';
            let i = 0;
            while (i < bijoyInput.length) {
                let foundMatch = false;
                for (const key of sortedBijoyKeys) {
                    if (bijoyInput.substring(i, i + key.length) === key) {
                        unicodeOutput += bijoyToUnicodeMap[key];
                        i += key.length;
                        foundMatch = true;
                        break;
                    }
                }
                if (!foundMatch) {
                    unicodeOutput += bijoyInput[i];
                    i++;
                }
            }

            // --- ধাপ ২: ইউনিকোড ডোমেইনে পুনঃক্রম এবং সংমিশ্রণ ---

            // ধ্রুবকগুলি সংজ্ঞায়িত করুন
            const unicodeIkar = '\u09BF'; // ি
            const unicodeEkar = '\u09C7'; // ে
            const unicodeOikar = '\u09C8'; // ৈ
            const unicodeConsonants = '\u0995-\u09B9\u09DC-\u09DF';
            const unicodeHasanta = '\u09CD';
            const unicodeRef = '\u09B0' + unicodeHasanta;

            // ধাপ ২.১: রেফ (র্) পুনঃক্রম করুন (আগে সরানো হয়েছে)
            // এই ধাপটি রেফকে তার যৌক্তিক অবস্থানে (ব্যঞ্জনবর্ণের আগে) নিয়ে আসে।
            // উদাহরণ: ক + র্ -> র্ + ক
            const consonantClusterWithoutRef = `(?:[${unicodeConsonants}](?:${unicodeHasanta}[${unicodeConsonants}])*)`;
            const rephReorderRegex = new RegExp(`(${consonantClusterWithoutRef})(${unicodeRef})`, 'g');
            unicodeOutput = unicodeOutput.replace(rephReorderRegex, '$2$1');

            // ধাপ ২.২: প্রি-সিডিং কার-চিহ্ন (ি, ে, ৈ) সঠিক স্থানে আনুন (পরে সরানো হয়েছে)
            // এই ধাপটি প্রি-ভাওয়েলগুলিকে তাদের যৌক্তিক অবস্থানে (ব্যঞ্জনবর্ণ/ক্লাস্টারের পরে) নিয়ে আসে।
            // ক্লাস্টার প্যাটার্নটি সঠিকভাবে এমন ক্লাস্টারগুলি পরিচালনা করে যা এখন একটি রেফ দিয়ে শুরু হতে পারে।
            const consonantClusterPattern = `(?:${unicodeRef})?(?:[${unicodeConsonants}](?:${unicodeHasanta}[${unicodeConsonants}])*)`;
            const reorderRegex = new RegExp(`([${unicodeIkar}${unicodeEkar}${unicodeOikar}])(${consonantClusterPattern})`, 'g');
            unicodeOutput = unicodeOutput.replace(reorderRegex, '$2$1');

            // ধাপ ২.৩: ও-কার এবং ঔ-কার গঠন করুন (আপনার দেওয়া নিয়ম অনুযায়ী)
            // এখন যেহেতু 'ে' সঠিক স্থানে আছে (ব্যঞ্জনবর্ণের পরে), আমরা 'ো' এবং 'ৌ' গঠন করতে পারি।
            // ব্যঞ্জনবর্ণ + ে + া -> ব্যঞ্জনবর্ণ + ো
            const unicodeAkar = '\u09BE'; // া
            const unicodeOkar = '\u09CB'; // ো
            unicodeOutput = unicodeOutput.replace(new RegExp(`(${unicodeEkar})(${unicodeAkar})`, 'g'), unicodeOkar);

            // ব্যঞ্জনবর্ণ + ে + ৗ -> ব্যঞ্জনবর্ণ + ৌ
            const unicodeOuKarPart2 = '\u09D7'; // ৗ
            const unicodeOukar = '\u09CC'; // ৌ
            unicodeOutput = unicodeOutput.replace(new RegExp(`(${unicodeEkar})(${unicodeOuKarPart2})`, 'g'), unicodeOukar);


            // ধাপ ৩: ম্যানুয়াল ইউনিকোড রিপ্লেসমেন্ট প্রয়োগ (যদি প্রয়োজন হয়)
            for (const [wrong, correct] of Object.entries(manualUnicodeReplacements)) {
                if (wrong) { // খালি কী এড়িয়ে চলুন
                    const regex = new RegExp(wrong.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'g');
                    unicodeOutput = unicodeOutput.replace(regex, correct);
                }
            }

            if (textAreaLeft) {
                textAreaLeft.value = unicodeOutput;
                addState('textAreaLeft');
            }
        }
        // ====================================================================
        // END: CORRECTED FUNCTION
        // ====================================================================


        function copyToClipboard(elementId) {
            const element = document.getElementById(elementId);
            if (element) {
                element.select();
                element.setSelectionRange(0, 99999); // মোবাইল ডিভাইসের জন্য

                try {
                    document.execCommand('copy');
                    // অ্যালার্টের পরিবর্তে কাস্টম মেসেজ বক্স
                    showCustomAlert('আউটপুট কপি করা হয়েছে!');
                } catch (err) {
                    console.error('কপি করতে ব্যর্থ:', err);
                    showCustomAlert('কপি করতে ব্যর্থ হয়েছে। অনুগ্রহ করে ম্যানুয়ালি কপি করুন।');
                }
            }
        }

        // কাস্টম অ্যালার্ট বক্স বাস্তবায়ন
        function showCustomAlert(message) {
            const alertBox = document.createElement('div');
            alertBox.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background-color: #333;
                color: white;
                padding: 15px 25px;
                border-radius: 8px;
                box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
                z-index: 1000;
                font-size: 1.1rem;
                opacity: 0;
                transition: opacity 0.3s ease-in-out;
            `;
            alertBox.textContent = message;
            document.body.appendChild(alertBox);

            // ফেড ইন
            setTimeout(() => {
                alertBox.style.opacity = 1;
            }, 10);

            // 2 সেকেন্ড পর ফেড আউট এবং সরান
            setTimeout(() => {
                alertBox.style.opacity = 0;
                alertBox.addEventListener('transitionend', () => alertBox.remove());
            }, 2000);
        }

        // টেক্সটএরিয়াগুলির জন্য আনডু/রিডু ইতিহাস
        let historyLeft = [];
        let historyIndexLeft = -1;
        let historyRight = [];
        let historyIndexRight = -1;

        function addState(textareaId) {
            const textarea = document.getElementById(textareaId);
            let history = textareaId === 'textAreaLeft' ? historyLeft : historyRight;
            let historyIndex = textareaId === 'textAreaLeft' ? historyIndexLeft : historyIndexRight;

            // যদি আমরা ইতিহাসের শেষে না থাকি, তবে পরবর্তী স্টেটগুলি পরিষ্কার করুন
            if (historyIndex < history.length - 1) {
                history.splice(historyIndex + 1);
            }

            history.push(textarea.value);
            historyIndex = history.length - 1;

            if (textareaId === 'textAreaLeft') {
                historyLeft = history;
                historyIndexLeft = historyIndex;
            } else {
                historyRight = history;
                historyIndexRight = historyIndex;
            }
            updateButtonStates(textareaId);
        }

        function undoText(textareaId) {
            const textarea = document.getElementById(textareaId);
            let history = textareaId === 'textAreaLeft' ? historyLeft : historyRight;
            let historyIndex = textareaId === 'textAreaLeft' ? historyIndexLeft : historyIndexRight;

            if (historyIndex > 0) {
                historyIndex--;
                textarea.value = history[historyIndex];
            }

            if (textareaId === 'textAreaLeft') {
                historyIndexLeft = historyIndex;
            } else {
                historyIndexRight = historyIndex;
            }
            updateButtonStates(textareaId);
        }

        function redoText(textareaId) {
            const textarea = document.getElementById(textareaId);
            let history = textareaId === 'textAreaLeft' ? historyLeft : historyRight;
            let historyIndex = textareaId === 'textAreaLeft' ? historyIndexLeft : historyIndexRight;

            if (historyIndex < history.length - 1) {
                historyIndex++;
                textarea.value = history[historyIndex];
            }

            if (textareaId === 'textAreaLeft') {
                historyIndexLeft = historyIndex;
            } else {
                historyIndexRight = historyIndex;
            }
            updateButtonStates(textareaId);
        }

        function clearTextarea(textareaId) {
            const textarea = document.getElementById(textareaId);
            if (textarea) {
                textarea.value = '';
                addState(textareaId); // এই ক্লিয়ার অ্যাকশনটি ইতিহাসে যোগ করুন
            }
        }

        function clearAllTextareas() {
            clearTextarea('textAreaLeft');
            clearTextarea('textAreaRight');
        }

        function updateButtonStates(textareaId) {
            let undoBtn = document.getElementById(textareaId === 'textAreaLeft' ? 'undoButtonLeft' : 'undoButtonRight');
            let redoBtn = document.getElementById(textareaId === 'textAreaLeft' ? 'redoButtonLeft' : 'redoButtonRight');
            let history = textareaId === 'textAreaLeft' ? historyLeft : historyRight;
            let historyIndex = textareaId === 'textAreaLeft' ? historyIndexLeft : historyIndexRight;

            if (undoBtn) undoBtn.disabled = historyIndex <= 0;
            if (redoBtn) redoBtn.disabled = historyIndex >= history.length - 1;
        }


        document.addEventListener('DOMContentLoaded', () => {
            console.log('DOMContentLoaded ইভেন্ট চালু হয়েছে। স্ক্রিপ্ট চলছে।');
            try {
                // --- ট্যাব পরিবর্তন লজিক ---
                const basicCalcTab = document.getElementById('basicCalcTab');
                const ageCalcTab = document.getElementById('ageCalcTab');
                const dateCalcTab = document.getElementById('dateCalcTab');
                const scientificCalcTab = document.getElementById('scientificCalcTab');
                const newsTab = document.getElementById('newsTab');
                const converterTab = document.getElementById('converterTab');
                const textAssistantTab = document.getElementById('textAssistantTab');
                const allFeaturesTab = document.getElementById('allFeaturesTab');
                const setApiKeyBtn = document.getElementById('setApiKeyBtn');

                const basicCalculatorContent = document.getElementById('basicCalculatorContent');
                const ageCalculatorContent = document.getElementById('ageCalculatorContent');
                const dateCalculatorContent = document.getElementById('dateCalculatorContent');
                const scientificCalculatorContent = document.getElementById('scientificCalculatorContent');
                const newsContent = document.getElementById('newsContent');
                const converterContent = document.getElementById('converterContent');
                const textAssistantContent = document.getElementById('textAssistantContent');
                const allFeaturesContent = document.getElementById('allFeaturesContent');

                // API কী মডেল উপাদান
                const apiKeyModal = document.getElementById('apiKeyModal');
                const apiKeyInput = document.getElementById('apiKeyInput');
                const saveApiKeyBtn = document.getElementById('saveApiKeyBtn');
                const cancelApiKeyBtn = document.getElementById('cancelApiKeyBtn');
                const apiKeyMessage = document.getElementById('apiKeyMessage');

                // নিশ্চিত করুন যে সমস্ত DOM উপাদান সঠিকভাবে নির্বাচিত হয়েছে
                console.log('basicCalcTab:', basicCalcTab);
                console.log('setApiKeyBtn:', setApiKeyBtn);
                console.log('apiKeyModal:', apiKeyModal);

                // প্রাথমিক ট্যাব প্রদর্শন
                showTab('basic'); // লোডে মৌলিক ক্যালকুলেটরকে সক্রিয় হিসাবে সেট করুন

                // API কী বোতামের স্টাইল আপডেট করার ফাংশন
                function updateApiKeyButton() {
                    if (setApiKeyBtn) {
                        const apiKey = localStorage.getItem('geminiApiKey');
                        if (apiKey) {
                            setApiKeyBtn.style.backgroundColor = '#28a745'; // সবুজ
                            setApiKeyBtn.style.color = 'white';
                            setApiKeyBtn.innerText = 'API কী সেট করা আছে';
                        } else {
                            setApiKeyBtn.style.backgroundColor = '#ef5350'; // লাল
                            setApiKeyBtn.style.color = 'white';
                            setApiKeyBtn.innerText = 'API কী সেট করুন';
                        }
                    }
                }

                // লোডে কল করুন
                updateApiKeyButton();


                function showTab(tabId) {
                    // সমস্ত ট্যাব নিষ্ক্রিয় করুন এবং সমস্ত কন্টেন্ট লুকান
                    [basicCalcTab, ageCalcTab, dateCalcTab, scientificCalcTab, newsTab, converterTab, textAssistantTab, allFeaturesTab].forEach(tab => {
                        if (tab) tab.classList.remove('active');
                    });
                    [basicCalculatorContent, ageCalculatorContent, dateCalculatorContent, scientificCalculatorContent, newsContent, converterContent, textAssistantContent, allFeaturesContent].forEach(content => {
                        if (content) content.classList.remove('active');
                    });

                    // নির্বাচিত ট্যাব সক্রিয় করুন এবং এর কন্টেন্ট দেখান
                    if (tabId === 'basic' && basicCalcTab && basicCalculatorContent) {
                        basicCalcTab.classList.add('active');
                        basicCalculatorContent.classList.add('active');
                    } else if (tabId === 'age' && ageCalcTab && ageCalculatorContent) {
                        ageCalcTab.classList.add('active');
                        ageCalculatorContent.classList.add('active');
                    } else if (tabId === 'date' && dateCalcTab && dateCalculatorContent) {
                        dateCalcTab.classList.add('active');
                        dateCalculatorContent.classList.add('active');
                    } else if (tabId === 'scientific' && scientificCalcTab && scientificCalculatorContent) {
                        scientificCalcTab.classList.add('active');
                        scientificCalculatorContent.classList.add('active');
                    } else if (tabId === 'news' && newsTab && newsContent) {
                        newsTab.classList.add('active');
                        newsContent.classList.add('active');
                    } else if (tabId === 'converter' && converterTab && converterContent) {
                        converterTab.classList.add('active');
                        converterContent.classList.add('active');
                    } else if (tabId === 'textAssistant' && textAssistantTab && textAssistantContent) {
                        textAssistantTab.classList.add('active');
                        textAssistantContent.classList.add('active');
                    } else if (tabId === 'allFeatures' && allFeaturesTab && allFeaturesContent) {
                        allFeaturesTab.classList.add('active');
                        allFeaturesContent.classList.add('active');
                    }
                    console.log(`ট্যাব পরিবর্তন করা হয়েছে: ${tabId}`);
                }

                if (basicCalcTab) basicCalcTab.addEventListener('click', () => showTab('basic'));
                if (ageCalcTab) ageCalcTab.addEventListener('click', () => showTab('age'));
                if (dateCalcTab) dateCalcTab.addEventListener('click', () => showTab('date'));
                if (scientificCalcTab) scientificCalcTab.addEventListener('click', () => showTab('scientific'));
                if (newsTab) newsTab.addEventListener('click', () => showTab('news'));
                if (converterTab) converterTab.addEventListener('click', () => showTab('converter'));
                if (textAssistantTab) textAssistantTab.addEventListener('click', () => showTab('textAssistant'));
                if (allFeaturesTab) allFeaturesTab.addEventListener('click', () => showTab('allFeatures'));

                // API কী সেটিং বোতাম এবং মডেল লজিক
                if (setApiKeyBtn) {
                    setApiKeyBtn.addEventListener('click', () => {
                        console.log('API কী সেট করুন বোতামে ক্লিক করা হয়েছে।');
                        if (apiKeyModal) {
                            apiKeyModal.classList.remove('hidden');
                            if (apiKeyInput) apiKeyInput.value = localStorage.getItem('geminiApiKey') || ''; // বর্তমান কী থাকলে দেখান
                            if (apiKeyMessage) apiKeyMessage.innerText = ''; // পূর্ববর্তী বার্তা পরিষ্কার করুন
                            console.log('API কী মডেল দেখানো হয়েছে।');
                        } else {
                            console.error('API কী মডেল উপাদান পাওয়া যায়নি।');
                        }
                    });
                } else {
                    console.error('API কী সেট করুন বোতাম পাওয়া যায়নি।');
                }

                if (saveApiKeyBtn) {
                    saveApiKeyBtn.addEventListener('click', () => {
                        console.log('API কী সেভ করুন বোতামে ক্লিক করা হয়েছে।');
                        const newApiKey = apiKeyInput ? apiKeyInput.value.trim() : '';
                        if (newApiKey) {
                            localStorage.setItem('geminiApiKey', newApiKey);
                            if (apiKeyMessage) {
                                apiKeyMessage.innerText = 'API কী সফলভাবে সেট করা হয়েছে!';
                                apiKeyMessage.classList.remove('error');
                                apiKeyMessage.classList.add('success');
                            }
                            console.log('API কী সফলভাবে সেভ করা হয়েছে।');
                            updateApiKeyButton(); // অবিলম্বে বোতামের স্টাইল আপডেট করুন
                            setTimeout(() => {
                                if (apiKeyModal) apiKeyModal.classList.add('hidden');
                            }, 1500); // 1.5 সেকেন্ড পর মডেল লুকান
                        } else {
                            if (apiKeyMessage) {
                                apiKeyMessage.innerText = 'অনুগ্রহ করে একটি বৈধ API কী লিখুন।';
                                apiKeyMessage.classList.remove('success');
                                apiKeyMessage.classList.add('error');
                            }
                            console.warn('অবৈধ API কী প্রবেশ করানো হয়েছে।');
                        }
                    });
                }

                if (cancelApiKeyBtn) {
                    cancelApiKeyBtn.addEventListener('click', () => {
                        console.log('API কী বাতিল করুন বোতামে ক্লিক করা হয়েছে।');
                        if (apiKeyModal) apiKeyModal.classList.add('hidden');
                    });
                }


                // --- মৌলিক ক্যালকুলেটর ক্লাস এবং লজিক ---
                class Calculator {
                    constructor(previousOperandTextElement, currentOperandTextElement) {
                        this.previousOperandTextElement = previousOperandTextElement;
                        this.currentOperandTextElement = currentOperandTextElement;
                        this.clear();
                    }

                    clear() {
                        this.currentOperand = '';
                        this.previousOperand = '';
                        this.operation = undefined;
                        this.updateDisplay();
                    }

                    delete() {
                        this.currentOperand = this.currentOperand.toString().slice(0, -1);
                        this.updateDisplay();
                    }

                    appendNumber(number) {
                        if (number === '.' && this.currentOperand.includes('.')) return;
                        this.currentOperand = this.currentOperand.toString() + number.toString();
                        this.updateDisplay();
                    }

                    chooseOperation(operation) {
                        if (this.currentOperand === '') return;
                        if (this.previousOperand !== '') {
                            this.compute();
                        }
                        this.operation = operation;
                        this.previousOperand = this.currentOperand;
                        this.currentOperand = '';
                        this.updateDisplay();
                    }

                    compute() {
                        let computation;
                        const prev = parseFloat(this.previousOperand);
                        const current = parseFloat(this.currentOperand);
                        if (isNaN(prev) || isNaN(current)) return;
                        switch (this.operation) {
                            case '+':
                                computation = prev + current;
                                break;
                            case '-':
                                computation = prev - current;
                                break;
                            case '×':
                                computation = prev * current;
                                break;
                            case '÷':
                                if (current === 0) {
                                    computation = 'Error';
                                } else {
                                    computation = prev / current;
                                }
                                break;
                            default:
                                return;
                        }
                        this.currentOperand = computation;
                        this.operation = undefined;
                        this.previousOperand = '';
                        this.updateDisplay();
                    }

                    getDisplayNumber(number) {
                        const stringNumber = number.toString();
                        const integerDigits = parseFloat(stringNumber.split('.')[0]);
                        const decimalDigits = stringNumber.split('.')[1];
                        let integerDisplay;
                        if (isNaN(integerDigits)) {
                            integerDisplay = '';
                        } else {
                            integerDisplay = integerDigits.toLocaleString('en', { maximumFractionDigits: 0 });
                        }
                        if (decimalDigits != null) {
                            return `${integerDisplay}.${decimalDigits}`;
                        } else {
                            return integerDisplay;
                        }
                    }

                    updateDisplay() {
                        if (this.currentOperandTextElement) {
                            this.currentOperandTextElement.innerText = this.getDisplayNumber(this.currentOperand);
                        }
                        if (this.previousOperandTextElement) {
                            if (this.operation != null) {
                                this.previousOperandTextElement.innerText =
                                    `${this.getDisplayNumber(this.previousOperand)} ${this.operation}`;
                            } else {
                                this.previousOperandTextElement.innerText = '';
                            }
                        }
                    }
                }

                // মৌলিক ক্যালকুলেটর DOM উপাদান এবং ইনিশিয়ালাইজেশন
                const numberButtons = document.querySelectorAll('[data-number]');
                const operatorButtons = document.querySelectorAll('[data-operator]');
                const equalsButton = document.querySelector('[data-equals]');
                const deleteButton = document.querySelector('[data-delete]');
                const allClearButton = document.querySelector('[data-all-clear]');
                const previousOperandTextElement = document.querySelector('[data-previous-operand]');
                const currentOperandTextElement = document.querySelector('[data-current-operand]');

                if (previousOperandTextElement && currentOperandTextElement) {
                    const basicCalculator = new Calculator(previousOperandTextElement, currentOperandTextElement);

                    // মৌলিক ক্যালকুলেটর বোতামগুলির জন্য ইভেন্ট লিসেনার
                    numberButtons.forEach(button => {
                        button.addEventListener('click', () => {
                            console.log('সংখ্যা বোতামে ক্লিক করা হয়েছে:', button.innerText);
                            basicCalculator.appendNumber(button.innerText);
                        });
                    });

                    operatorButtons.forEach(button => {
                        button.addEventListener('click', () => {
                            console.log('অপারেটর বোতামে ক্লিক করা হয়েছে:', button.innerText);
                            basicCalculator.chooseOperation(button.innerText);
                        });
                    });

                    if (equalsButton) {
                        equalsButton.addEventListener('click', () => {
                            console.log('সমান বোতামে ক্লিক করা হয়েছে।');
                            basicCalculator.compute();
                        });
                    }

                    if (allClearButton) {
                        allClearButton.addEventListener('click', () => {
                            console.log('সব পরিষ্কার বোতামে ক্লিক করা হয়েছে।');
                            basicCalculator.clear();
                        });
                    }

                    if (deleteButton) {
                        deleteButton.addEventListener('click', () => {
                            console.log('মুছুন বোতামে ক্লিক করা হয়েছে।');
                            basicCalculator.delete();
                        });
                    }

                    // মৌলিক ক্যালকুলেটরের জন্য কীবোর্ড ইনপুট সমর্থন
                    document.addEventListener('keydown', e => {
                        if (!basicCalculatorContent || !basicCalculatorContent.classList.contains('active')) return;

                        if (e.key >= '0' && e.key <= '9' || e.key === '.') {
                            basicCalculator.appendNumber(e.key);
                        } else if (e.key === '+' || e.key === '-' || e.key === '*' || e.key === '/') {
                            let operatorKey = e.key;
                            if (operatorKey === '*') operatorKey = '×';
                            if (operatorKey === '/') operatorKey = '÷';
                            basicCalculator.chooseOperation(operatorKey);
                        } else if (e.key === 'Enter' || e.key === '=') {
                            e.preventDefault();
                            basicCalculator.compute();
                        } else if (e.key === 'Backspace') {
                            basicCalculator.delete();
                        } else if (e.key === 'Escape') {
                            basicCalculator.clear();
                        }
                    });
                } else {
                    console.error('মৌলিক ক্যালকুলেটর ডিসপ্লে উপাদান পাওয়া যায়নি।');
                }


                // মৌলিক ক্যালকুলেটর ব্যাখ্যা বৈশিষ্ট্য
                const explainBasicBtn = document.getElementById('explainBasicBtn');
                const basicExplanation = document.getElementById('basicExplanation');
                const basicExplanationLoading = document.getElementById('basicExplanationLoading');

                if (explainBasicBtn && basicExplanation && basicExplanationLoading) {
                    explainBasicBtn.addEventListener('click', async () => {
                        console.log('মৌলিক ব্যাখ্যা বোতামে ক্লিক করা হয়েছে।');
                        const currentExpression = previousOperandTextElement.innerText + currentOperandTextElement.innerText;
                        let fullExpression = currentExpression.trim();

                        if (!fullExpression) {
                            basicExplanation.innerText = 'ব্যাখ্যার জন্য একটি এক্সপ্রেশন লিখুন।';
                            return;
                        }

                        basicExplanation.innerText = '';
                        basicExplanationLoading.style.display = 'block';
                        explainBasicBtn.disabled = true;

                        try {
                            const apiKey = localStorage.getItem('geminiApiKey');
                            if (!apiKey) {
                                basicExplanation.innerText = 'জেমিনি API কী সেট করা হয়নি। অনুগ্রহ করে "API কী সেট করুন" বাটনে ক্লিক করে কী সেট করুন।';
                                basicExplanationLoading.style.display = 'none';
                                explainBasicBtn.disabled = false;
                                return;
                            }

                            let chatHistory = [];
                            chatHistory.push({ role: "user", parts: [{ text: `এই গাণিতিক এক্সপ্রেশনটি সহজ ভাষায় ব্যাখ্যা করুন: "${fullExpression}"। এটি কী করে এবং এর মূল ধারণা কী?` }] });
                            const payload = { contents: chatHistory };
                            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

                            const response = await fetch(apiUrl, {
                                method: 'POST',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify(payload)
                            });

                            const result = await response.json();

                            if (result.candidates && result.candidates.length > 0 &&
                                result.candidates[0].content && result.candidates[0].content.parts &&
                                result.candidates[0].content.parts.length > 0) {
                                const text = result.candidates[0].content.parts[0].text;
                                basicExplanation.innerText = text;
                            } else {
                                basicExplanation.innerText = 'জেমিনি থেকে কোনো প্রতিক্রিয়া পাওয়া যায়নি।';
                                console.error('জেমিনি API প্রতিক্রিয়া অপ্রত্যাশিত:', result);
                            }
                        } catch (error) {
                            basicExplanation.innerText = 'জেমিনি API কল করার সময় একটি ত্রুটি হয়েছে: ' + error.message;
                            console.error('জেমিনি API ত্রুটি:', error);
                        } finally {
                            basicExplanationLoading.style.display = 'none';
                            explainBasicBtn.disabled = false;
                        }
                    });
                } else {
                    console.error('মৌলিক ব্যাখ্যা উপাদান পাওয়া যায়নি।');
                }


                // --- বয়স ক্যালকুলেটর লজিক ---
                const birthDateInput = document.getElementById('birthDate');
                const currentDateInput = document.getElementById('currentDate');
                const calculateAgeBtn = document.getElementById('calculateAgeBtn');
                const ageResult = document.getElementById('ageResult');
                const ageErrorMessage = document.getElementById('ageErrorMessage');


                // বর্তমান তারিখ ইনপুটের জন্য বর্তমান তারিখ ডিফল্ট হিসাবে সেট করুন
                const todayCurrentDate = new Date();
                const todayCurrentDateString = todayCurrentDate.toISOString().split('T')[0];
                if (currentDateInput) currentDateInput.value = todayCurrentDateString;

                if (calculateAgeBtn) {
                    calculateAgeBtn.addEventListener('click', () => {
                        console.log('বয়স গণনা করুন বোতামে ক্লিক করা হয়েছে।');
                        calculateAge();
                    });
                }

                function calculateAge() {
                    const birthDateValue = birthDateInput ? birthDateInput.value : '';
                    const currentDateValue = currentDateInput ? currentDateInput.value : '';

                    // পূর্ববর্তী বার্তা পরিষ্কার করুন
                    if (ageResult) ageResult.innerText = '';
                    if (ageErrorMessage) ageErrorMessage.innerText = '';

                    if (!birthDateValue || !currentDateValue) {
                        if (ageErrorMessage) ageErrorMessage.innerText = 'অনুগ্রহ করে জন্ম তারিখ এবং বর্তমান তারিখ উভয়ই নির্বাচন করুন।';
                        return;
                    }

                    const birthDate = new Date(birthDateValue);
                    const currentDate = new Date(currentDateValue);

                    if (birthDate > currentDate) {
                        if (ageErrorMessage) ageErrorMessage.innerText = 'জন্ম তারিখ বর্তমান তারিখের চেয়ে বেশি হতে পারে না।';
                        return;
                    }

                    let years = currentDate.getFullYear() - birthDate.getFullYear();
                    let months = currentDate.getMonth() - birthDate.getMonth();
                    let days = currentDate.getDate() - birthDate.getDate();

                    // দিনগুলি নেতিবাচক হলে মাস এবং বছর সামঞ্জস্য করুন
                    if (days < 0) {
                        months--;
                        // বর্তমান তারিখের পূর্ববর্তী মাসের দিনের সংখ্যা পান
                        const prevMonthLastDay = new Date(currentDate.getFullYear(), currentDate.getMonth(), 0).getDate();
                        days += prevMonthLastDay;
                    }

                    // মাসগুলি নেতিবাচক হলে বছর সামঞ্জস্য করুন
                    if (months < 0) {
                        years--;
                        months += 12;
                    }

                    if (ageResult) ageResult.innerText = `আপনার বয়স: ${years} বছর, ${months} মাস, ${days} দিন।`;
                }

                // --- তারিখ ও সময় ক্যালকুলেটর লজিক ---
                const showTodayDatesBtn = document.getElementById('showTodayDatesBtn');
                const showTomorrowDatesBtn = document.getElementById('showTomorrowDatesBtn');

                const todayResultSection = document.getElementById('todayResultSection');
                const tomorrowResultSection = document.getElementById('tomorrowResultSection');

                const todayGregorianDateDisplay = document.getElementById('todayGregorianDateDisplay');
                const todayBengaliDateDisplay = document.getElementById('todayBengaliDateDisplay');
                const todayHijriDateDisplay = document.getElementById('todayHijriDateDisplay');
                const todayDayDisplay = document.getElementById('todayDayDisplay'); // আজকের দিনের জন্য নতুন উপাদান
                const todayTimeDisplay = document.getElementById('todayTimeDisplay');

                const tomorrowGregorianDateDisplay = document.getElementById('tomorrowGregorianDateDisplay');
                const tomorrowBengaliDateDisplay = document.getElementById('tomorrowBengaliDateDisplay');
                const tomorrowHijriDateDisplay = document.getElementById('tomorrowHijriDateDisplay');
                const tomorrowDayDisplay = document.getElementById('tomorrowDayDisplay'); // আগামীকালের দিনের জন্য নতুন উপাদান
                const tomorrowTimeDisplay = document.getElementById('tomorrowTimeDisplay');

                // নতুন তারিখ কনভার্টার DOM উপাদান
                const englishDateInput = document.getElementById('englishDateInput');
                const convertEnglishToBengaliBtn = document.getElementById('convertEnglishToBengaliBtn');
                const convertedBengaliDate = document.getElementById('convertedBengaliDate');
                const convertedDayDisplay = document.getElementById('convertedDayDisplay'); // রূপান্তরিত দিনের জন্য নতুন উপাদান


                if (showTodayDatesBtn) {
                    showTodayDatesBtn.addEventListener('click', () => {
                        console.log('আজকের তারিখ দেখান বোতামে ক্লিক করা হয়েছে।');
                        displayDates('today');
                    });
                }
                if (showTomorrowDatesBtn) {
                    showTomorrowDatesBtn.addEventListener('click', () => {
                        console.log('আগামীকালের তারিখ দেখান বোতামে ক্লিক করা হয়েছে।');
                        displayDates('tomorrow');
                    });
                }

                // গ্রেগরিয়ান তারিখকে বাংলা তারিখে রূপান্তর করার ফাংশন (বাংলাদেশ স্ট্যান্ডার্ড)
                function getBengaliDate(gregorianDate) {
                    const year = gregorianDate.getFullYear();
                    const month = gregorianDate.getMonth(); // 0-11
                    const day = gregorianDate.getDate();

                    let bengaliYear;
                    const bengaliMonthNames = [
                        "বৈশাখ", "জ্যৈষ্ঠ", "আষাঢ়", "শ্রাবণ", "ভাদ্র", "আশ্বিন",
                        "কার্তিক", "অগ্রহায়ণ", "পৌষ", "মাঘ", "ফাল্গুন", "চৈত্র"
                    ];

                    // বাংলা বছর গণনা করুন (বাংলাদেশ স্ট্যান্ডার্ড: পহেলা বৈশাখ 14 এপ্রিল)
                    if (month < 3 || (month === 3 && day < 14)) { // 14 এপ্রিলের আগে
                        bengaliYear = year - 594;
                    } else { // 14 এপ্রিল বা তার পরে
                        bengaliYear = year - 593;
                    }

                    // বাংলা মাসের দিন সংখ্যা (বাংলাদেশ স্ট্যান্ডার্ড)
                    // বৈশাখ থেকে ভাদ্র (5 মাস): 31 দিন
                    // আশ্বিন থেকে চৈত্র (7 মাস): সাধারণত 30 দিন, অধিবর্ষে ফাল্গুন 31 দিন
                    const bengaliMonthLengths = [31, 31, 31, 31, 31, 30, 30, 30, 30, 30, 30, 30];

                    // বাংলা বছরের সাথে সম্পর্কিত গ্রেগরিয়ান বছরটি অধিবর্ষ কিনা তা নির্ধারণ করুন
                    // এটি ফাল্গুনকে প্রভাবিত করে (11তম মাস, সূচক 10)
                    const gregorianYearForBengaliLeapCheck = bengaliYear + 593;
                    const isGregorianLeapYear = (gregorianYearForBengaliLeapCheck % 4 === 0 && gregorianYearForBengaliLeapCheck % 100 !== 0) || gregorianYearForBengaliLeapCheck % 400 === 0;

                    if (isGregorianLeapYear) {
                        bengaliMonthLengths[10] = 31; // অধিবর্ষে ফাল্গুন 31 দিন
                    }

                    // বর্তমান বাংলা বছরের শুরু থেকে অতিবাহিত দিন গণনা করুন (14 এপ্রিল)
                    const startOfCurrentBengaliYearGregorian = new Date(year, 3, 14); // বর্তমান গ্রেগরিয়ান বছরের 14 এপ্রিল
                    if (gregorianDate < startOfCurrentBengaliYearGregorian) {
                        // যদি বর্তমান তারিখ 14 এপ্রিলের আগে হয়, তবে পূর্ববর্তী গ্রেগরিয়ান বছরের 14 এপ্রিলকে রেফারেন্স হিসাবে সামঞ্জস্য করুন
                        startOfCurrentBengaliYearGregorian.setFullYear(year - 1);
                    }

                    const diffTime = gregorianDate.getTime() - startOfCurrentBengaliYearGregorian.getTime();
                    let daysPassedSinceBengaliYearStart = Math.floor(diffTime / (1000 * 60 * 60 * 24));

                    let currentBengaliMonthIndex = 0;
                    let currentBengaliDay = 0;

                    // সঠিক মাস এবং দিন খুঁজে বের করতে বাংলা মাসগুলির মধ্যে পুনরাবৃত্তি করুন
                    for (let i = 0; i < bengaliMonthNames.length; i++) {
                        if (daysPassedSinceBengaliYearStart < bengaliMonthLengths[i]) {
                            currentBengaliMonthIndex = i;
                            currentBengaliDay = daysPassedSinceBengaliYearStart + 1; // দিন 1-ইনডেক্সড
                            break;
                        }
                        daysPassedSinceBengaliYearStart -= bengaliMonthLengths[i];
                    }

                    // সংখ্যাগুলিকে বাংলা সংখ্যায় রূপান্তর করুন
                    const toBengaliNumber = (num) => {
                        const numbers = ['০', '১', '২', '৩', '৪', '৫', '৬', '৭', '৮', '৯'];
                        return num.toString().split('').map(digit => numbers[parseInt(digit)]).join('');
                    };

                    // বাংলা মাসের মোট দিন
                    const totalDaysInBengaliMonth = bengaliMonthLengths[currentBengaliMonthIndex];

                    return {
                        day: currentBengaliDay,
                        month: bengaliMonthNames[currentBengaliMonthIndex],
                        year: bengaliYear,
                        totalDays: totalDaysInBengaliMonth,
                        formatted: `${toBengaliNumber(currentBengaliDay)} ${bengaliMonthNames[currentBengaliMonthIndex]}, ${toBengaliNumber(bengaliYear)} বঙ্গাব্দ`
                    };
                }

                // আরবি সংখ্যাকে বাংলা সংখ্যায় রূপান্তর করার ফাংশন
                const arabicToBengaliNumbers = (text) => {
                    const arabicDigits = ['٠', '١', '٢', '٣', '٤', '٥', '٦', '٧', '٨', '٩'];
                    const bengaliDigits = ['০', '১', '২', '৩', '৪', '৫', '৬', '৭', '৮', '৯'];
                    let converted = text;
                    for (let i = 0; i < arabicDigits.length; i++) {
                        converted = converted.replace(new RegExp(arabicDigits[i], 'g'), bengaliDigits[i]);
                    }
                    return converted;
                    };

                // আরবি হিজরি মাসের নামগুলিকে বাংলা নামে ম্যাপ করুন
                const hijriMonthArabicToBengali = {
                    'محرم': 'মুহাররম',
                    'صفر': 'সফর',
                    'ربيع الأول': 'রবিউল আউয়াল',
                    'ربيع الآخر': 'রবিউস সানি',
                    'جمادى الأولى': 'জমাদিউল আউয়াল',
                    'جمادى الآخرة': 'জমাদিউস সানি',
                    'رجب': 'রজব',
                    'شعبان': 'শাবান',
                    'رمضان': 'রমজান',
                    'شوال': 'শাওয়াল',
                    'ذو القعدة': 'জিলকদ',
                    'ذو الحجة': 'জিলহজ'
                };

                function displayDates(period) {
                    console.log(`তারিখগুলি প্রদর্শন করা হচ্ছে: ${period}`);
                    // প্রথমে উভয় বিভাগ পরিষ্কার করুন
                    if (todayResultSection) todayResultSection.style.display = 'none';
                    if (tomorrowResultSection) tomorrowResultSection.style.display = 'none';

                    // পূর্ববর্তী কন্টেন্ট পরিষ্কার করুন
                    if (todayGregorianDateDisplay) todayGregorianDateDisplay.innerHTML = '';
                    if (todayBengaliDateDisplay) todayBengaliDateDisplay.innerHTML = '';
                    if (todayHijriDateDisplay) todayHijriDateDisplay.innerHTML = '';
                    if (todayDayDisplay) todayDayDisplay.innerHTML = ''; // দিনের ডিসপ্লে পরিষ্কার করুন
                    if (todayTimeDisplay) todayTimeDisplay.innerHTML = '';

                    if (tomorrowGregorianDateDisplay) tomorrowGregorianDateDisplay.innerHTML = '';
                    if (tomorrowBengaliDateDisplay) tomorrowBengaliDateDisplay.innerHTML = '';
                    if (tomorrowHijriDateDisplay) tomorrowHijriDateDisplay.innerHTML = '';
                    if (tomorrowDayDisplay) tomorrowDayDisplay.innerHTML = ''; // দিনের ডিসপ্লে পরিষ্কার করুন
                    if (tomorrowTimeDisplay) tomorrowTimeDisplay.innerHTML = '';

                    let dateToDisplay = new Date(); // ডিফল্ট হিসাবে আজ
                    if (period === 'tomorrow') {
                        dateToDisplay.setDate(dateToDisplay.getDate() + 1); // আগামীকালের তারিখের জন্য
                    }

                    // --- তারিখ গণনা ---
                    // গ্রেগরিয়ান তারিখ
                    const gregorianDateFormatted = dateToDisplay.toLocaleDateString('bn-BD', {
                        year: 'numeric',
                        month: 'long',
                        day: 'numeric'
                    });
                    const dayOfWeek = dateToDisplay.toLocaleDateString('bn-BD', { weekday: 'long' }); // সপ্তাহের দিন পান

                    // বাংলা তারিখ
                    const bengaliDateInfo = getBengaliDate(dateToDisplay);
                    const bengaliDateFormatted = bengaliDateInfo.formatted;

                    // হিজরি তারিখ (প্রয়োজনে স্থানীয় কনভেনশনের জন্য সামঞ্জস্য করা হয়েছে)
                    let hijriCalculationDate = new Date(dateToDisplay);
                    // ব্যবহারকারীর পর্যবেক্ষণের সাথে মিলানোর জন্য হিজরির জন্য -2 দিনের সামঞ্জস্য পুনরায় চালু করা হচ্ছে
                    // এই সামঞ্জস্য স্থানীয় চাঁদ দেখা ভিত্তিক ক্যালেন্ডারের সাথে সারিবদ্ধ করার জন্য সাধারণ, ১ দিন বা ২ দিন আগে পরে করতে নিচের লজিকের মান বসাতে হবে
                    hijriCalculationDate.setDate(hijriCalculationDate.getDate() - 2);

                    const hijriDateFormatter = new Intl.DateTimeFormat('ar-SA', {
                        calendar: 'islamic',
                        year: 'numeric',
                        month: 'long',
                        day: 'numeric',
                        timeZone: 'Asia/Dhaka'
                    });
                    const hijriParts = hijriDateFormatter.formatToParts(hijriCalculationDate);

                    let hijriDay = '';
                    let hijriMonthArabic = '';
                    let hijriYear = '';

                    for (const part of hijriParts) {
                        if (part.type === 'day') {
                            hijriDay = arabicToBengaliNumbers(part.value);
                        } else if (part.type === 'month') {
                            hijriMonthArabic = part.value;
                        } else if (part.type === 'year') {
                            hijriYear = arabicToBengaliNumbers(part.value);
                        }
                    }
                    const hijriMonthBengali = hijriMonthArabicToBengali[hijriMonthArabic] || hijriMonthArabic;
                    const hijriDateFormatted = `${hijriDay} ${hijriMonthBengali} ${hijriYear} হিজরি`;

                    // সময়
                    const timeFormatted = dateToDisplay.toLocaleTimeString('bn-BD', {
                        hour: '2-digit',
                        minute: '2-digit',
                        second: '2-digit',
                        hour12: true,
                        timeZone: 'Asia/Dhaka' // বাংলাদেশের সময়ের জন্য স্পষ্টভাবে সেট করুন
                    });

                    // 26 বা তার বেশি তারিখের জন্য হাইলাইট লজিক
                    let gregorianHighlightClass = '';
                    if (dateToDisplay.getDate() >= 26) {
                        gregorianHighlightClass = 'text-red-800'; // গাঢ় লাল
                    }

                    let bengaliHighlightClass = '';
                    if (bengaliDateInfo.day >= 26) {
                        bengaliHighlightClass = 'text-red-800'; // গাঢ় লাল
                    }

                    let hijriHighlightClass = '';
                    // তুলনার জন্য hijriDay কে সংখ্যায় রূপান্তর করুন
                    if (parseInt(hijriDay) >= 26) {
                        hijriHighlightClass = 'text-red-800'; // গাঢ় লাল
                    }


                    if (period === 'today') {
                        if (todayResultSection) todayResultSection.style.display = 'block';
                        if (todayGregorianDateDisplay) todayGregorianDateDisplay.innerHTML = `<strong>খ্রিষ্টাব্দ:</strong> <span class="${gregorianHighlightClass}">${gregorianDateFormatted}</span>`;
                        if (todayBengaliDateDisplay) todayBengaliDateDisplay.innerHTML = `<strong>বাংলা তারিখ:</strong> <span class="${bengaliHighlightClass}">${bengaliDateFormatted}</span>`;
                        if (todayHijriDateDisplay) todayHijriDateDisplay.innerHTML = `<strong>হিজরি:</strong> <span class="${hijriHighlightClass}">${hijriDateFormatted}</span>`;
                        if (todayDayDisplay) todayDayDisplay.innerHTML = `<strong>বার:</strong> ${dayOfWeek}`; // দিন প্রদর্শন করুন
                        if (todayTimeDisplay) todayTimeDisplay.innerHTML = `<strong>সময়:</strong> ${timeFormatted}`;
                    } else if (period === 'tomorrow') {
                        if (tomorrowResultSection) tomorrowResultSection.style.display = 'block';
                        if (tomorrowGregorianDateDisplay) tomorrowGregorianDateDisplay.innerHTML = `<strong>খ্রিষ্টাব্দ:</strong> <span class="${gregorianHighlightClass}">${gregorianDateFormatted}</span>`;
                        if (tomorrowBengaliDateDisplay) tomorrowBengaliDateDisplay.innerHTML = `<strong>বাংলা তারিখ:</strong> <span class="${bengaliHighlightClass}">${bengaliDateFormatted}</span>`;
                        if (tomorrowHijriDateDisplay) tomorrowHijriDateDisplay.innerHTML = `<strong>হিজরি:</strong> <span class="${hijriHighlightClass}">${hijriDateFormatted}</span>`;
                        if (tomorrowDayDisplay) tomorrowDayDisplay.innerHTML = `<strong>বার:</strong> ${dayOfWeek}`; // দিন প্রদর্শন করুন
                        if (tomorrowTimeDisplay) tomorrowTimeDisplay.innerHTML = `<strong>সময়:</strong> ${timeFormatted}`;
                    }
                }

                // ইংরেজি থেকে বাংলা তারিখ রূপান্তর লজিক
                if (convertEnglishToBengaliBtn) {
                    convertEnglishToBengaliBtn.addEventListener('click', () => {
                        console.log('ইংরেজি থেকে বাংলা রূপান্তর বোতামে ক্লিক করা হয়েছে।');
                        const englishDateValue = englishDateInput ? englishDateInput.value : '';
                        if (!englishDateValue) {
                            if (convertedBengaliDate) convertedBengaliDate.innerText = 'অনুগ্রহ করে একটি ইংরেজি তারিখ নির্বাচন করুন।';
                            if (convertedDayDisplay) convertedDayDisplay.innerText = ''; // দিনের ডিসপ্লে পরিষ্কার করুন
                            return;
                        }

                        const gregorianDate = new Date(englishDateValue);
                        if (isNaN(gregorianDate.getTime())) { // অবৈধ তারিখ পরীক্ষা
                            if (convertedBengaliDate) convertedBengaliDate.innerText = 'অবৈধ তারিখ ফরম্যাট।';
                            if (convertedDayDisplay) convertedDayDisplay.innerText = ''; // দিনের ডিসপ্লে পরিষ্কার করুন
                            return;
                        }

                        const bengaliDateInfo = getBengaliDate(gregorianDate);
                        const dayOfWeek = gregorianDate.toLocaleDateString('bn-BD', { weekday: 'long' }); // সপ্তাহের দিন পান

                        if (convertedBengaliDate) convertedBengaliDate.innerHTML = `<strong>বাংলা তারিখ:</strong> ${bengaliDateInfo.formatted}`;
                        if (convertedDayDisplay) convertedDayDisplay.innerHTML = `<strong>বার:</strong> ${dayOfWeek}`;
                    });
                }


                // --- বৈজ্ঞানিক ক্যালকুলেটর লজিক ---
                const scientificExpressionInput = document.getElementById('scientificExpressionInput');
                const scientificButtons = document.querySelectorAll('.scientific-buttons-grid button');
                const scientificResultDisplay = document.getElementById('scientificResult');
                const scientificErrorMessage = document.getElementById('scientificErrorMessage');
                // বৈজ্ঞানিক ব্যাখ্যা উপাদানগুলির জন্য সঠিক আইডি
                const explainScientificBtn = document.getElementById('explainScientificBtn');
                const scientificExplanation = document.getElementById('scientificExplanation');
                const scientificExplanationLoading = document.getElementById('scientificExplanationLoading');

                const functionsWithParentheses = ['sin', 'cos', 'tan', 'log', 'ln', 'sqrt'];

                // এক্সপ্রেশন ইনপুটে বোতামের মান যোগ করুন
                scientificButtons.forEach(button => {
                    button.addEventListener('click', () => {
                        console.log('বৈজ্ঞানিক বোতামে ক্লিক করা হয়েছে:', button.dataset.sciInput);
                        const value = button.dataset.sciInput;
                        const inputElement = scientificExpressionInput;

                        if (value === 'C') { // ক্লিয়ার হ্যান্ডেল করুন
                            if (inputElement) inputElement.value = '';
                            if (scientificResultDisplay) scientificResultDisplay.innerText = '';
                            if (scientificErrorMessage) scientificErrorMessage.innerText = '';
                            if (scientificExplanation) scientificExplanation.innerText = '';
                        } else if (value === 'DEL') { // মুছুন হ্যান্ডেল করুন
                            if (inputElement) inputElement.value = inputElement.value.slice(0, -1);
                        } else if (button.dataset.sciEquals !== undefined) { // সমান হ্যান্ডেল করুন
                            evaluateScientificExpression();
                        } else if (functionsWithParentheses.includes(value)) { // () প্রয়োজন এমন ফাংশন হ্যান্ডেল করুন
                            if (inputElement) {
                                const start = inputElement.selectionStart;
                                const end = inputElement.selectionEnd;
                                const text = inputElement.value;
                                const newValue = text.substring(0, start) + value + '()' + text.substring(end);
                                inputElement.value = newValue;
                                // বন্ধনীর ভিতরে কার্সার অবস্থান করুন
                                inputElement.selectionStart = start + value.length + 1;
                                inputElement.selectionEnd = start + value.length + 1;
                                inputElement.focus();
                            }
                        }
                        else if (value) { // অন্যান্য মান যোগ করুন
                            if (inputElement) inputElement.value += value;
                        }
                    });
                });

                // কীবোর্ড ইনপুট সমর্থন
                if (scientificExpressionInput) {
                    scientificExpressionInput.addEventListener('keydown', (e) => {
                        if (e.key === 'Enter') {
                            e.preventDefault();
                            evaluateScientificExpression();
                        } else if (e.key === 'Escape') {
                            if (scientificExpressionInput) scientificExpressionInput.value = '';
                            if (scientificResultDisplay) scientificResultDisplay.innerText = '';
                            if (scientificErrorMessage) scientificErrorMessage.innerText = '';
                            if (scientificExplanation) scientificExplanation.innerText = '';
                        }
                    });
                }

                function evaluateScientificExpression() {
                    const expression = scientificExpressionInput ? scientificExpressionInput.value : '';
                    if (scientificResultDisplay) scientificResultDisplay.innerText = '';
                    if (scientificErrorMessage) scientificErrorMessage.innerText = '';
                    if (scientificExplanation) scientificExplanation.innerText = '';

                    if (expression.trim() === '') {
                        if (scientificErrorMessage) scientificErrorMessage.innerText = 'অনুগ্রহ করে একটি এক্সপ্রেশন লিখুন।';
                        return;
                    }

                    // মৌলিক বন্ধনী ভারসাম্য পরীক্ষা
                    let openParentheses = (expression.match(/\(/g) || []).length;
                    let closeParentheses = (expression.match(/\)/g) || []).length;
                    if (openParentheses !== closeParentheses) {
                        if (scientificErrorMessage) scientificErrorMessage.innerText = 'বন্ধনী সঠিকভাবে বন্ধ করা হয়নি।';
                        return;
                    }

                    try {
                        let processedExpression = expression
                            .replace(/sin\(/g, 'Math.sin(Math.PI / 180 * ')
                            .replace(/cos\(/g, 'Math.cos(Math.PI / 180 * ')
                            .replace(/tan\(/g, 'Math.tan(Math.PI / 180 * ')
                            .replace(/log\(/g, 'Math.log10(')
                            .replace(/ln\(/g, 'Math.log(')
                            .replace(/sqrt\(/g, 'Math.sqrt(')
                            .replace(/\^/g, '**')
                            .replace(/π/g, 'Math.PI')
                            .replace(/e/g, 'Math.E')
                            .replace(/×/g, '*') // '×' কে '*' এ রূপান্তর করুন
                            .replace(/÷/g, '/'); // '÷' কে '/' এ রূপান্তর করুন

                        let result = eval(processedExpression);

                        if (isNaN(result) || !isFinite(result)) {
                            if (scientificErrorMessage) scientificErrorMessage.innerText = 'অবৈধ এক্সপ্রেশন বা ফলাফল।';
                        } else {
                            if (scientificResultDisplay) scientificResultDisplay.innerText = result.toLocaleString('en', { maximumFractionDigits: 10 });
                        }
                    } catch (error) {
                        if (scientificErrorMessage) scientificErrorMessage.innerText = 'এক্সপ্রেশন ত্রুটি: ' + error.message + '। অনুগ্রহ করে সঠিক সিনট্যাক্স ব্যবহার করুন।';
                        console.error('বৈজ্ঞানিক ক্যালকুলেটর ত্রুটি:', error);
                    }
                }

                // বৈজ্ঞানিক এক্সপ্রেশন ব্যাখ্যার জন্য জেমিনি API কল
                if (explainScientificBtn) {
                    explainScientificBtn.addEventListener('click', async () => {
                        console.log('বৈজ্ঞানিক ব্যাখ্যা বোতামে ক্লিক করা হয়েছে।');
                        const expressionToExplain = scientificExpressionInput ? scientificExpressionInput.value.trim() : '';
                        if (!expressionToExplain) {
                            if (scientificExplanation) scientificExplanation.innerText = 'ব্যাখ্যার জন্য একটি এক্সপ্রেশন লিখুন।';
                            return;
                        }

                        if (scientificExplanation) scientificExplanation.innerText = '';
                        if (scientificExplanationLoading) scientificExplanationLoading.style.display = 'block';
                        if (explainScientificBtn) explainScientificBtn.disabled = true;

                        try {
                            const apiKey = localStorage.getItem('geminiApiKey');
                            if (!apiKey) {
                                if (scientificExplanation) scientificExplanation.innerText = 'জেমিনি API কী সেট করা হয়নি। অনুগ্রহ করে "API কী সেট করুন" বাটনে ক্লিক করে কী সেট করুন।';
                                if (scientificExplanationLoading) scientificExplanationLoading.style.display = 'none';
                                if (explainScientificBtn) explainScientificBtn.disabled = false;
                                return;
                            }

                            let chatHistory = [];
                            chatHistory.push({ role: "user", parts: [{ text: `এই গাণিতিক এক্সপ্রেশন বা ফাংশনটি সহজ ভাষায় ব্যাখ্যা করুন: "${expressionToExplain}"। এটি কী করে এবং এর মূল ধারণা কী?` }] });
                            const payload = { contents: chatHistory };
                            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

                            const response = await fetch(apiUrl, {
                                method: 'POST',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify(payload)
                            });

                            const result = await response.json();

                            if (result.candidates && result.candidates.length > 0 &&
                                result.candidates[0].content && result.candidates[0].content.parts &&
                                result.candidates[0].content.parts.length > 0) {
                                const text = result.candidates[0].content.parts[0].text;
                                if (scientificExplanation) scientificExplanation.innerText = text;
                            } else {
                                if (scientificExplanation) scientificExplanation.innerText = 'জেমিনি থেকে কোনো প্রতিক্রিয়া পাওয়া যায়নি।';
                                console.error('জেমিনি API প্রতিক্রিয়া অপ্রত্যাশিত:', result);
                            }
                        } catch (error) {
                            if (scientificExplanation) scientificExplanation.innerText = 'জেমিনি API কল করার সময় একটি ত্রুটি হয়েছে: ' + error.message;
                            console.error('জেমিনি API ত্রুটি:', error);
                        } finally {
                            if (scientificExplanationLoading) scientificExplanationLoading.style.display = 'none';
                            if (explainScientificBtn) explainScientificBtn.disabled = false;
                        }
                    });
                } else {
                    console.error('বৈজ্ঞানিক ব্যাখ্যা উপাদান পাওয়া যায়নি।');
                }


                // --- সাম্প্রতিক সংবাদ লজিক ---
                // সংবাদ বিভাগের জন্য HTML এ যা আছে তার বাইরে কোনো নির্দিষ্ট লজিক প্রয়োজন নেই।


                // --- ফন্ট কনভার্টার লজিক (আনডু/রিডু সহ) ---
                const textAreaLeft = document.getElementById('textAreaLeft');
                const textAreaRight = document.getElementById('textAreaRight');

                // উভয় টেক্সট এলাকার জন্য ইতিহাস ইনিশিয়ালাইজ করুন
                if (textAreaLeft) {
                    addState('textAreaLeft');
                    textAreaLeft.addEventListener('input', () => addState('textAreaLeft'));
                }
                if (textAreaRight) {
                    addState('textAreaRight');
                    textAreaRight.addEventListener('input', () => addState('textAreaRight'));
                }

// --- টেক্সট অ্যাসিস্ট্যান্ট (চ্যাট) লজিক ---
const assistantInput = document.getElementById('assistantInput');
const askGeminiBtn = document.getElementById('askGeminiBtn');
const chatWindow = document.getElementById('chatWindow');
const assistantLoading = document.getElementById('assistantLoading');
const clearChatBtn = document.getElementById('clearChatBtn');

let chatHistory = []; // কথোপকথনের ইতিহাস সংরক্ষণ করে

// চ্যাট উইন্ডোতে বার্তা যোগ করার জন্য হেল্পার ফাংশন
function addMessageToChat(text, sender) {
    const messageElement = document.createElement('div');
    messageElement.classList.add('message', `${sender}-message`);
    // XSS প্রতিরোধ করতে innerText ব্যবহার করা হচ্ছে
    messageElement.innerText = text; 
    if(chatWindow) {
        chatWindow.appendChild(messageElement);
        // স্বয়ংক্রিয়ভাবে নতুন বার্তায় স্ক্রোল করুন
        chatWindow.scrollTop = chatWindow.scrollHeight; 
    }
}

// চ্যাট মুছুন বোতামের কার্যকারিতা
if(clearChatBtn) {
    clearChatBtn.addEventListener('click', () => {
        if(chatWindow) chatWindow.innerHTML = '';
        chatHistory = []; // ইতিহাস রিসেট করুন
        addMessageToChat('হ্যালো! আমি আপনার টেক্সট অ্যাসিস্ট্যান্ট। আমি আপনাকে কীভাবে সাহায্য করতে পারি?', 'gemini');
    });
}

// জেমিনিকে জিজ্ঞাসা করার বোতামের কার্যকারিতা
if (askGeminiBtn) {
    askGeminiBtn.addEventListener('click', handleAskGemini);
}

// Enter চেপে বার্তা পাঠানোর সুবিধা
if(assistantInput) {
    assistantInput.addEventListener('keydown', (e) => {
        // Shift+Enter চাপলে নতুন লাইন তৈরি হবে, শুধু Enter চাপলে বার্তা যাবে
        if (e.key === 'Enter' && !e.shiftKey) {
            e.preventDefault(); // ডিফল্ট Enter আচরণ (নতুন লাইন) বন্ধ করুন
            handleAskGemini();
        }
    });
}

async function handleAskGemini() {
    const prompt = assistantInput.value.trim();
    if (!prompt || !chatWindow) return;

    // ব্যবহারকারীর বার্তা প্রদর্শন করুন
    addMessageToChat(prompt, 'user');
    assistantInput.value = ''; // ইনপুট বক্স পরিষ্কার করুন

    // ব্যবহারকারীর বার্তা ইতিহাসে যোগ করুন
    chatHistory.push({ role: "user", parts: [{ text: prompt }] });

    // লোডিং ইন্ডিকেটর দেখান
    if(assistantLoading) assistantLoading.style.display = 'block';
    if(askGeminiBtn) askGeminiBtn.disabled = true;

    try {
        const apiKey = localStorage.getItem('geminiApiKey');
        if (!apiKey) {
            addMessageToChat('জেমিনি API কী সেট করা হয়নি। অনুগ্রহ করে "API কী সেট করুন" বাটনে ক্লিক করে কী সেট করুন।', 'gemini-error');
            return;
        }

        // কথোপকথনের ধারাবাহিকতা বজায় রাখতে সম্পূর্ণ chatHistory পাঠানো হচ্ছে
        const payload = { contents: chatHistory };
        // লেটেস্ট ফ্ল্যাশ মডেল ব্যবহার করা হচ্ছে
        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

        const response = await fetch(apiUrl, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(payload)
        });

        const result = await response.json();
        let geminiText;

        if (result.candidates && result.candidates.length > 0 &&
            result.candidates[0].content && result.candidates[0].content.parts &&
            result.candidates[0].content.parts.length > 0) {
            geminiText = result.candidates[0].content.parts[0].text;
            // জেমিনির উত্তর ইতিহাসে যোগ করুন
            chatHistory.push({ role: "model", parts: [{ text: geminiText }] });
        } else {
            geminiText = 'দুঃখিত, আমি কোনো উত্তর খুঁজে পাইনি। অনুগ্রহ করে আবার চেষ্টা করুন।';
            console.error('API Response Error:', result);
        }
        addMessageToChat(geminiText, 'gemini');

    } catch (error) {
        const errorMessage = 'একটি ত্রুটি ঘটেছে: ' + error.message;
        addMessageToChat(errorMessage, 'gemini-error');
        console.error('API Call Error:', error);
    } finally {
        if(assistantLoading) assistantLoading.style.display = 'none';
        if(askGeminiBtn) askGeminiBtn.disabled = false;
    }
}

 // *** সংশোধিত: প্রাথমিক বার্তাটি এখানে যোগ করা হয়েছে ***
                if(chatWindow) {
                    addMessageToChat('হ্যালো! আমি আপনার টেক্সট অ্যাসিস্ট্যান্ট। আমি আপনাকে কীভাবে সাহায্য করতে পারি?', 'gemini');
                }

            } catch (e) {
                console.error('DOMContentLoaded এক্সিকিউশনের সময় একটি ত্রুটি ঘটেছে:', e);
                const mainContainer = document.querySelector('.main-container');
                if (mainContainer) {
                    const errorMessageDiv = document.createElement('div');
                    errorMessageDiv.className = 'text-red-600 font-bold mt-4 p-4 border border-red-300 rounded-lg';
                    errorMessageDiv.innerText = 'অ্যাপ লোড করতে সমস্যা হয়েছে। অনুগ্রহ করে কনসোল চেক করুন।';
                    mainContainer.prepend(errorMessageDiv);
                }
            }
        });
    </script>
</body>
</html>